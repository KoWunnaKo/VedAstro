//⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣠⠤⠶⠶⠶⠤⠤⣄⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⡤⠚⠋⠉⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠳⢤⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⠀⣠⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⢦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⣠⠞⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠳⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⡼⢣⡶⠀⠀⠀⠀⠀⣠⠖⠉⣀⡴⠶⠊⢷⡆⠀⠀⠀⠀⠀⠀⠀⠀⢹⡄⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⢀⣼⠃⡼⠁⠀⠀⠀⣠⠞⣡⡴⠋⠁⠀⠀⠀⠘⣿⣧⡀⠀⠀⠀⣇⠀⠀⠸⡇⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⣼⡏⢠⡇⠀⠀⠀⣼⣣⠞⠃⠀⠀⠀⣀⣠⣤⣄⣿⡇⢧⡀⠀⠀⢻⣄⡀⠀⡗⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⢸⡇⢸⡇⠀⢠⣼⣿⣏⡀⠀⠀⢠⢾⠛⠉⠁⢀⣿⡉⠛⣷⣄⠀⢸⣿⠻⣶⣧⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠘⡇⠀⣇⡴⢿⣿⡉⠉⠉⠁⠀⠀⠀⣀⣶⠾⢿⡛⠟⢶⣼⡇⠀⢸⢻⡀⣹⣿⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⣧⠀⢸⡆⣿⣛⠩⣿⣷⠀⠀⠀⠀⠙⠉⣷⢾⣿⡇⠾⠀⢻⠀⢸⠇⣽⠛⢹⡇⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⢸⡄⠀⠻⣏⠛⠳⡿⢿⡞⠀⠀⠀⠀⠀⠾⠿⠿⠇⠆⠀⠀⣆⣼⣱⡇⠀⠈⣧⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⢳⠀⠀⠙⡄⠀⠙⠉⢹⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢿⡿⠁⢿⡀⠀⢸⣇⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠈⢧⠀⠀⢻⡄⠀⠀⠈⡷⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⠇⢰⠘⡇⠀⠈⢿⣆⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠈⢷⡀⠘⡟⠦⣀⠀⠀⠒⠒⠋⠉⠁⠀⠀⢀⣠⠆⠀⣹⠀⣈⡇⢹⡄⠀⠸⣿⡄⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⠀⠱⣄⣷⠀⢹⡳⣄⡀⠀⠀⠀⠀⣀⡴⠚⠁⠀⠀⣿⠀⣟⢿⠈⡇⠀⠀⣹⣻⡀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⠀⠀⣼⠻⣧⣿⠇⢰⡍⠳⠤⣴⠛⠁⠀⠀⠀⠀⢰⣿⠀⡿⢸⠀⢸⡀⢀⣿⡇⣿⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⠀⣠⠇⢀⡼⠋⢀⣮⡇⣀⠴⡟⠀⠀⠀⠀⠀⠀⣿⠃⠻⣅⣼⠀⢸⡇⢸⣹⠀⣿⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⢀⠏⢀⡞⢀⣀⡸⠟⠋⠁⠘⠁⠀⠀⠀⠀⠀⠀⣿⠀⠀⠉⠳⢄⣸⣧⣧⣟⡼⠉⠀⠀⠀
//⠀⠀⠀⠀⢀⡤⠿⠤⠚⢲⣟⣁⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⡀⡀⠀⢀⣀⠙⠛⠿⢾⣄⠀⠀⠀⠀
//⠀⠀⢀⡴⠋⠀⠀⠀⠀⠀⠀⠀⠉⠉⠉⠛⠓⠀⠴⠒⠒⠚⠒⠛⠛⣿⡉⠉⠉⠀⠀⠀⠀⠀⠀⠙⢢⡀⠀
//⠀⠀⣸⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⣿⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢿⣄
//⠀⢸⢹⠀⠀⠀⢀⡤⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠓⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿
//⠀⠀⢸⠀⠀⢀⣾⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣶⡄⠀⠀⠀⠀⠀⠀⠀⣼⠛
//⠀⠀⠸⣇⣰⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⡇⠀⠀⠀⠀⠀⠀⢀⡏⠀
//⠀⠀⣰⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢷⠀⠀⠀⠀⠀⠀⣼⠀⠀
//⠀⡞⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡶⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⡇⠀⠀⠀⠀⣰⠃⠀⠀
//⣼⢃⣴⡃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⠀⠀⠀⢳⠀⠀⠀⢠⠏⠀⠀⠀
//⣿⠈⠿⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣹⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢤⣶⠀⠀⢸⠀⠀⠀⣾⠀⠀⠀⠀
//⢹⡆⠀⠀⠐⠊⠀⠀⠀⠀⠀⠀⠀⠀⠈⢻⡀⠀⠀⠀⠀⠀⠀⠀⣄⠀⠉⠈⠀⠀⡼⠀⠀⢰⡇⠀⠀⠀⠀
//⠀⠹⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡄⠀⠀⢳⡀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⣸⠃⠀⠀⣼⠀⠀⠀⠀⠀
//⠀⠀⠈⠳⢤⣀⣀⣀⣀⣀⡴⠖⠋⠀⠀⠀⠀⠙⠦⣀⠀⠀⠀⠀⠀⠀⢀⣠⠾⠁⠀⠀⢰⡏⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⣇⢻⠉⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠓⠒⠒⠒⠋⠉⣿⠀⠀⠀⠀⣸⠁⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⢽⣼⠀⠀⠄⠀⠀⠀⠀⠀⠀⠲⣄⠀⠀⠀⠀⠀⠀⠀⠀⢀⡇⠀⠀⠀⢠⡇⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠳⣄⠀⠀⠀⠀⠀⠀⣸⠁⠀⠀⠀⣸⠁⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⣿⡇⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠈⠳⣄⠀⠀⠀⠀⡿⠀⠀⠀⢰⡇⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⢿⣿⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⠃⠀⠀⠀⢸⠃⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⢸⢹⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⠀⠀⠀⠀⢼⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⢸⡼⣇⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢘⣿⠀⠀⠀⠀⣸⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⠘⣧⣿⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⠀⢠⡏⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⠀⣹⠃⠀⠀⠀⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣄⠀⠀⣾⠃⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⠀⢠⡟⠀⠀⠀⠀⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢦⣴⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⢀⡾⠀⠀⠀⠀⠀⣽⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠳⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⠀⡼⠁⠀⠀⠀⠀⠈⠿⠛⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠳⡄⠀⠀⠀⠀⠀⠀⠀
//⠀⠀⠀⠀⣸⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢦⣀⠀⠀⠀⠀⠀


using SwissEphNet;
using System;
using System.Collections.Generic;
using System.Linq;

namespace VedAstro.Library
{
    public static partial class AstronomicalCalculator
    {
        #region Cached Functions
        //CACHED FUNCTIONS
        //NOTE : These are functions that don't call other functions from this class
        //       Only functions that don't call other cached functions are allowed to be cached
        //       otherwise, it's erroneous in parallel

        public static Angle GetAyanamsa(Time time)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetAyanamsa", time), _getAyanamsa);


            //UNDERLYING FUNCTION
            Angle _getAyanamsa()
            {
                int year = LmtToUtc(time).Year;

                var returnValue = new Angle(seconds: (long)(Math.Round((year - 397) * 50.3333333333)));

                return returnValue;
            }

        }


        /// <summary>
        /// NOTE This method connects SwissEph Library with Muhurta Library
        /// </summary>
        [API("SayanaLongitude")]
        public static Angle GetPlanetSayanaLongitude(Time time, PlanetName planetName)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetPlanetSayanaLongitude", time, planetName), _getPlanetSayanaLongitude);


            //UNDERLYING FUNCTION

            Angle _getPlanetSayanaLongitude()
            {
                //Converts LMT to UTC (GMT)
                //DateTimeOffset utcDate = lmtDateTime.ToUniversalTime();

                int iflag = SwissEph.SEFLG_SWIEPH;  //+ SwissEph.SEFLG_SPEED;
                double[] results = new double[6];
                string err_msg = "";
                double jul_day_ET;
                SwissEph ephemeris = new SwissEph();

                // Convert DOB to ET
                jul_day_ET = TimeToEphemerisTime(time);

                //convert planet name, compatible with Swiss Eph
                int swissPlanet = Tools.VedAstroToSwissEph(planetName);

                //Get planet long
                int ret_flag = ephemeris.swe_calc(jul_day_ET, swissPlanet, iflag, results, ref err_msg);

                //data in results at index 0 is longitude
                return new Angle(degrees: results[0]);

            }


        }

        [API("SayanaLatitude")]
        public static Angle GetPlanetSayanaLatitude(Time time, PlanetName planetName)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetPlanetSayanaLatitude", time, planetName), _getPlanetSayanaLatitude);


            //UNDERLYING FUNCTION

            Angle _getPlanetSayanaLatitude()
            {
                //Converts LMT to UTC (GMT)
                //DateTimeOffset utcDate = lmtDateTime.ToUniversalTime();

                int planet = 0;
                int iflag = SwissEph.SEFLG_SWIEPH;  //+ SwissEph.SEFLG_SPEED;
                double[] results = new double[6];
                string err_msg = "";
                double jul_day_ET;
                SwissEph ephemeris = new SwissEph();

                // Convert DOB to ET
                jul_day_ET = TimeToEphemerisTime(time);


                //Convert PlanetName to SE_PLANET type
                if (planetName == PlanetName.Sun)
                    planet = SwissEph.SE_SUN;
                else if (planetName == PlanetName.Moon)
                {
                    planet = SwissEph.SE_MOON;
                }
                else if (planetName == PlanetName.Mars)
                {
                    planet = SwissEph.SE_MARS;
                }
                else if (planetName == PlanetName.Mercury)
                {
                    planet = SwissEph.SE_MERCURY;
                }
                else if (planetName == PlanetName.Jupiter)
                {
                    planet = SwissEph.SE_JUPITER;
                }
                else if (planetName == PlanetName.Venus)
                {
                    planet = SwissEph.SE_VENUS;
                }
                else if (planetName == PlanetName.Saturn)
                {
                    planet = SwissEph.SE_SATURN;
                }
                else if (planetName == PlanetName.Rahu)
                {
                    planet = SwissEph.SE_MEAN_NODE;
                }
                else if (planetName == PlanetName.Ketu)
                {
                    planet = SwissEph.SE_MEAN_NODE;
                }

                //Get planet long
                int ret_flag = ephemeris.swe_calc(jul_day_ET, planet, iflag, results, ref err_msg);

                //data in results at index 1 is latitude
                return new Angle(degrees: results[1]);

            }


        }


        [API("Speed")]
        public static double GetPlanetSpeed(Time time, PlanetName planetName)
        {
            //Converts LMT to UTC (GMT)
            //DateTimeOffset utcDate = lmtDateTime.ToUniversalTime();

            int planet = 0;
            int iflag = SwissEph.SEFLG_SWIEPH | SwissEph.SEFLG_SPEED;
            double[] results = new double[6];
            string err_msg = "";
            double jul_day_ET;
            SwissEph ephemeris = new SwissEph();

            // Convert DOB to ET
            jul_day_ET = TimeToEphemerisTime(time);


            //Convert PlanetName to SE_PLANET type
            if (planetName == PlanetName.Sun)
                planet = SwissEph.SE_SUN;
            else if (planetName == PlanetName.Moon)
            {
                planet = SwissEph.SE_MOON;
            }
            else if (planetName == PlanetName.Mars)
            {
                planet = SwissEph.SE_MARS;
            }
            else if (planetName == PlanetName.Mercury)
            {
                planet = SwissEph.SE_MERCURY;
            }
            else if (planetName == PlanetName.Jupiter)
            {
                planet = SwissEph.SE_JUPITER;
            }
            else if (planetName == PlanetName.Venus)
            {
                planet = SwissEph.SE_VENUS;
            }
            else if (planetName == PlanetName.Saturn)
            {
                planet = SwissEph.SE_SATURN;
            }
            else if (planetName == PlanetName.Rahu)
            {
                planet = SwissEph.SE_MEAN_NODE;
            }
            else if (planetName == PlanetName.Ketu)
            {
                planet = SwissEph.SE_MEAN_NODE;
            }

            //Get planet long
            int ret_flag = ephemeris.swe_calc(jul_day_ET, planet, iflag, results, ref err_msg);

            //data in results at index 3 is speed in right ascension (deg/day)
            return results[3];
        }

        /// <summary>
        /// Converts Planet Longitude to Constellation equivelant
        /// Gets info about the constellation at a given longitude, ie. Constellation Name,
        /// Quarter, Degrees in constellation, etc.
        /// </summary>
        public static PlanetConstellation GetConstellationAtLongitude(Angle planetLongitude)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetPlanetConstellation", planetLongitude), _getPlanetConstellation);


            //UNDERLYING FUNCTION
            PlanetConstellation _getPlanetConstellation()
            {
                //get planet's longitude in minutes
                var planetLongitudeInMinutes = planetLongitude.TotalMinutes;

                //The ecliptic is divided into 27 constellations
                //of 13° 20' (800') each. Hence divide 800
                var roughConstellationNumber = planetLongitudeInMinutes / 800.0;

                //get constellation number (rounds up)
                var constellationNumber = (int)Math.Ceiling(roughConstellationNumber);

                //calculate quarter from remainder
                int quarter;

                var remainder = roughConstellationNumber - Math.Floor(roughConstellationNumber);

                if (remainder >= 0 && remainder <= 0.25) quarter = 1;
                else if (remainder > 0.25 && remainder <= 0.5) quarter = 2;
                else if (remainder > 0.5 && remainder <= 0.75) quarter = 3;
                else if (remainder > 0.75 && remainder <= 1) quarter = 4;
                else quarter = 0;

                //calculate "degrees in constellation" from the remainder
                var minutesInConstellation = remainder * 800.0;
                var degreesInConstellation = new Angle(0, minutesInConstellation, 0);


                //put together all the info of this point in the constellation
                var constellation = new PlanetConstellation(constellationNumber, quarter, degreesInConstellation);

                //return constellation value
                return constellation;
            }

        }


        /// <summary>
        /// Converts Planet Longitude to Zodiac Sign equivelant
        /// </summary>
        public static ZodiacSign GetZodiacSignAtLongitude(Angle longitude)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetZodiacSignAtLongitude", longitude), _getZodiacSignAtLongitude);


            //UNDERLYING FUNCTION
            ZodiacSign _getZodiacSignAtLongitude()
            {
                //max degrees of each sign
                const double maxDegreesInSign = 30.0;

                //get rough zodiac number
                double roughZodiacNumber = (longitude.TotalDegrees % 360.0) / maxDegreesInSign;

                //Calculate degrees in zodiac sign
                //get remainder from rough zodiac number
                var roughZodiacNumberRemainder = roughZodiacNumber - Math.Truncate(roughZodiacNumber);

                //convert remainder to degrees in current sign
                var degreesInSignRaw = roughZodiacNumberRemainder * maxDegreesInSign;
                //round number (too high accuracy causes equality mismtach because of minute difference)
                var degreesInSign = Math.Round(degreesInSignRaw, 4);

                //if degrees in sign is 0, it means 30 degrees
                if (degreesInSign == 0)
                {
                    //change value to 30 degrees
                    degreesInSign = 30;
                }

                //Get name of zodiac sign
                //round to ceiling to get integer zodiac number
                var zodiacNumber = (int)Math.Ceiling(roughZodiacNumber);

                //convert zodiac number to zodiac name
                var calculatedZodiac = (ZodiacName)zodiacNumber;

                //if rough zodiac number is less than or equal 0, then return Pisces else return calculated zodiac
                ZodiacName currentSignName = (roughZodiacNumber <= 0) ? ZodiacName.Pisces : calculatedZodiac;

                //return new instance of planet sign
                var degreesAngle = Angle.FromDegrees(Math.Abs(degreesInSign)); //make always positive

                var zodiacSignAtLongitude = new ZodiacSign(currentSignName, degreesAngle);

                return zodiacSignAtLongitude;
            }


        }

        /// <summary>
        /// Converts Planet Longitude to Zodiac Sign equivelant
        /// </summary>
        public static Angle GetLongitudeAtZodiacSign(ZodiacSign zodiacSign)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetLongitudeAtZodiacSign", zodiacSign), _getLongitudeAtZodiacSign);


            //UNDERLYING FUNCTION
            Angle _getLongitudeAtZodiacSign()
            {

                //convert zodic name to its number equivelant in order
                var zodiacNumber = (int)zodiacSign.GetSignName();

                //calculate planet longitude to sign just before
                var zodiacBefore = zodiacNumber - 1;
                var maxDegreesInSign = 30.0;
                var longtiudeToBefore = Angle.FromDegrees(maxDegreesInSign * zodiacBefore);

                //add planet longitude from sign just before with
                //degrees already traversed in current sign
                var totalLongitude = longtiudeToBefore + zodiacSign.GetDegreesInSign();

                return totalLongitude;
            }


        }

        #region Longitude Converters



        #endregion

        [API("DayOfWeek")]
        public static DayOfWeek GetDayOfWeek(Time time)
        {
            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetDayOfWeek", time), _getDayOfWeek);


            //UNDERLYING FUNCTION
            DayOfWeek _getDayOfWeek()
            {
                //The Hindu day begins with sunrise and continues till
                //next sunrise.The first hora on any day will be the
                //first hour after sunrise and the last hora, the hour
                //before sunrise the next day.

                //TODO Change to new day system
                //TODO make test first

                var sunRise = AstronomicalCalculator.GetSunriseTime(time);

                //get week day name in string
                var dayOfWeekNameInString = time.GetLmtDateTimeOffset().DayOfWeek.ToString();

                //convert string to day of week type
                Enum.TryParse(dayOfWeekNameInString, out DayOfWeek dayOfWeek);

                //return to caller
                return dayOfWeek;
            }


        }

        /// <summary>
        /// Gets hora lord based on hora number & week day
        /// </summary>
        public static PlanetName GetLordOfHora(int hora, DayOfWeek day)
        {
            switch (day)
            {
                case DayOfWeek.Sunday:
                    switch (hora)
                    {
                        case 1: return PlanetName.Sun;
                        case 2: return PlanetName.Venus;
                        case 3: return PlanetName.Mercury;
                        case 4: return PlanetName.Moon;
                        case 5: return PlanetName.Saturn;
                        case 6: return PlanetName.Jupiter;
                        case 7: return PlanetName.Mars;
                        case 8: return PlanetName.Sun;
                        case 9: return PlanetName.Venus;
                        case 10: return PlanetName.Mercury;
                        case 11: return PlanetName.Moon;
                        case 12: return PlanetName.Saturn;
                        case 13: return PlanetName.Jupiter;
                        case 14: return PlanetName.Mars;
                        case 15: return PlanetName.Sun;
                        case 16: return PlanetName.Venus;
                        case 17: return PlanetName.Mercury;
                        case 18: return PlanetName.Moon;
                        case 19: return PlanetName.Saturn;
                        case 20: return PlanetName.Jupiter;
                        case 21: return PlanetName.Mars;
                        case 22: return PlanetName.Sun;
                        case 23: return PlanetName.Venus;
                        case 24: return PlanetName.Mercury;
                    }
                    break;
                case DayOfWeek.Monday:
                    switch (hora)
                    {
                        case 1: return PlanetName.Moon;
                        case 2: return PlanetName.Saturn;
                        case 3: return PlanetName.Jupiter;
                        case 4: return PlanetName.Mars;
                        case 5: return PlanetName.Sun;
                        case 6: return PlanetName.Venus;
                        case 7: return PlanetName.Mercury;
                        case 8: return PlanetName.Moon;
                        case 9: return PlanetName.Saturn;
                        case 10: return PlanetName.Jupiter;
                        case 11: return PlanetName.Mars;
                        case 12: return PlanetName.Sun;
                        case 13: return PlanetName.Venus;
                        case 14: return PlanetName.Mercury;
                        case 15: return PlanetName.Moon;
                        case 16: return PlanetName.Saturn;
                        case 17: return PlanetName.Jupiter;
                        case 18: return PlanetName.Mars;
                        case 19: return PlanetName.Sun;
                        case 20: return PlanetName.Venus;
                        case 21: return PlanetName.Mercury;
                        case 22: return PlanetName.Moon;
                        case 23: return PlanetName.Saturn;
                        case 24: return PlanetName.Jupiter;
                    }
                    break;
                case DayOfWeek.Tuesday:
                    switch (hora)
                    {
                        case 1: return PlanetName.Mars;
                        case 2: return PlanetName.Sun;
                        case 3: return PlanetName.Venus;
                        case 4: return PlanetName.Mercury;
                        case 5: return PlanetName.Moon;
                        case 6: return PlanetName.Saturn;
                        case 7: return PlanetName.Jupiter;
                        case 8: return PlanetName.Mars;
                        case 9: return PlanetName.Sun;
                        case 10: return PlanetName.Venus;
                        case 11: return PlanetName.Mercury;
                        case 12: return PlanetName.Moon;
                        case 13: return PlanetName.Saturn;
                        case 14: return PlanetName.Jupiter;
                        case 15: return PlanetName.Mars;
                        case 16: return PlanetName.Sun;
                        case 17: return PlanetName.Venus;
                        case 18: return PlanetName.Mercury;
                        case 19: return PlanetName.Moon;
                        case 20: return PlanetName.Saturn;
                        case 21: return PlanetName.Jupiter;
                        case 22: return PlanetName.Mars;
                        case 23: return PlanetName.Sun;
                        case 24: return PlanetName.Venus;
                    }
                    break;
                case DayOfWeek.Wednesday:
                    switch (hora)
                    {
                        case 1: return PlanetName.Mercury;
                        case 2: return PlanetName.Moon;
                        case 3: return PlanetName.Saturn;
                        case 4: return PlanetName.Jupiter;
                        case 5: return PlanetName.Mars;
                        case 6: return PlanetName.Sun;
                        case 7: return PlanetName.Venus;
                        case 8: return PlanetName.Mercury;
                        case 9: return PlanetName.Moon;
                        case 10: return PlanetName.Saturn;
                        case 11: return PlanetName.Jupiter;
                        case 12: return PlanetName.Mars;
                        case 13: return PlanetName.Sun;
                        case 14: return PlanetName.Venus;
                        case 15: return PlanetName.Mercury;
                        case 16: return PlanetName.Moon;
                        case 17: return PlanetName.Saturn;
                        case 18: return PlanetName.Jupiter;
                        case 19: return PlanetName.Mars;
                        case 20: return PlanetName.Sun;
                        case 21: return PlanetName.Venus;
                        case 22: return PlanetName.Mercury;
                        case 23: return PlanetName.Moon;
                        case 24: return PlanetName.Saturn;
                    }
                    break;
                case DayOfWeek.Thursday:
                    switch (hora)
                    {
                        case 1: return PlanetName.Jupiter;
                        case 2: return PlanetName.Mars;
                        case 3: return PlanetName.Sun;
                        case 4: return PlanetName.Venus;
                        case 5: return PlanetName.Mercury;
                        case 6: return PlanetName.Moon;
                        case 7: return PlanetName.Saturn;
                        case 8: return PlanetName.Jupiter;
                        case 9: return PlanetName.Mars;
                        case 10: return PlanetName.Sun;
                        case 11: return PlanetName.Venus;
                        case 12: return PlanetName.Mercury;
                        case 13: return PlanetName.Moon;
                        case 14: return PlanetName.Saturn;
                        case 15: return PlanetName.Jupiter;
                        case 16: return PlanetName.Mars;
                        case 17: return PlanetName.Sun;
                        case 18: return PlanetName.Venus;
                        case 19: return PlanetName.Mercury;
                        case 20: return PlanetName.Moon;
                        case 21: return PlanetName.Saturn;
                        case 22: return PlanetName.Jupiter;
                        case 23: return PlanetName.Mars;
                        case 24: return PlanetName.Sun;
                    }
                    break;
                case DayOfWeek.Friday:
                    switch (hora)
                    {
                        case 1: return PlanetName.Venus;
                        case 2: return PlanetName.Mercury;
                        case 3: return PlanetName.Moon;
                        case 4: return PlanetName.Saturn;
                        case 5: return PlanetName.Jupiter;
                        case 6: return PlanetName.Mars;
                        case 7: return PlanetName.Sun;
                        case 8: return PlanetName.Venus;
                        case 9: return PlanetName.Mercury;
                        case 10: return PlanetName.Moon;
                        case 11: return PlanetName.Saturn;
                        case 12: return PlanetName.Jupiter;
                        case 13: return PlanetName.Mars;
                        case 14: return PlanetName.Sun;
                        case 15: return PlanetName.Venus;
                        case 16: return PlanetName.Mercury;
                        case 17: return PlanetName.Moon;
                        case 18: return PlanetName.Saturn;
                        case 19: return PlanetName.Jupiter;
                        case 20: return PlanetName.Mars;
                        case 21: return PlanetName.Sun;
                        case 22: return PlanetName.Venus;
                        case 23: return PlanetName.Mercury;
                        case 24: return PlanetName.Moon;
                    }
                    break;
                case DayOfWeek.Saturday:
                    switch (hora)
                    {
                        case 1: return PlanetName.Saturn;
                        case 2: return PlanetName.Jupiter;
                        case 3: return PlanetName.Mars;
                        case 4: return PlanetName.Sun;
                        case 5: return PlanetName.Venus;
                        case 6: return PlanetName.Mercury;
                        case 7: return PlanetName.Moon;
                        case 8: return PlanetName.Saturn;
                        case 9: return PlanetName.Jupiter;
                        case 10: return PlanetName.Mars;
                        case 11: return PlanetName.Sun;
                        case 12: return PlanetName.Venus;
                        case 13: return PlanetName.Mercury;
                        case 14: return PlanetName.Moon;
                        case 15: return PlanetName.Saturn;
                        case 16: return PlanetName.Jupiter;
                        case 17: return PlanetName.Mars;
                        case 18: return PlanetName.Sun;
                        case 19: return PlanetName.Venus;
                        case 20: return PlanetName.Mercury;
                        case 21: return PlanetName.Moon;
                        case 22: return PlanetName.Saturn;
                        case 23: return PlanetName.Jupiter;
                        case 24: return PlanetName.Mars;
                    }
                    break;
            }

            throw new Exception("Did not find hora, something wrong!");

        }

        /// <summary>
        /// Gets the junction point (sandhi) between 2 consecutive
        /// houses, where one house begins and the other ends.
        /// </summary>
        public static Angle GetHouseJunctionPoint(Angle previousHouse, Angle nextHouse)
        {
            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetHouseJunctionPoint", previousHouse, nextHouse), _getHouseJunctionPoint);


            //UNDERLYING FUNCTION
            Angle _getHouseJunctionPoint()
            {
                //Add the longitudes of two consecutive Bhavas (house)
                //and divide the sum by 2. The result represents sandhi (junction point of houses).

                //get sum of house longitudes
                var longitudeSum = previousHouse + nextHouse;

                Angle junctionPoint;

                //if next house longitude is lower than previous house longitude
                //next house is after 360 degrees
                if (nextHouse < previousHouse)
                {
                    //add 360 to longitude sum
                    longitudeSum = longitudeSum + Angle.Degrees360;

                    //divide sum by 2 to get junction point
                    junctionPoint = longitudeSum.Divide(2);

                    //correct junction point by subtracting 360
                    junctionPoint = junctionPoint - Angle.Degrees360;
                }
                else
                {
                    //divide sum by 2 to get junction point
                    junctionPoint = longitudeSum.Divide(2);
                }

                //return junction point
                return junctionPoint;

            }

        }

        public static PlanetName GetLordOfZodiacSign(ZodiacName signName)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetLordOfZodiacSign", signName), _getLordOfZodiacSign);


            //UNDERLYING FUNCTION
            PlanetName _getLordOfZodiacSign()
            {
                switch (signName)
                {
                    //Aries and Scorpio are ruled by Mars;
                    case ZodiacName.Aries:
                    case ZodiacName.Scorpio:
                        return PlanetName.Mars;

                    //Taurus and Libra by Venus;
                    case ZodiacName.Taurus:
                    case ZodiacName.Libra:
                        return PlanetName.Venus;

                    //Gemini and Virgo by Mercury;
                    case ZodiacName.Gemini:
                    case ZodiacName.Virgo:
                        return PlanetName.Mercury;

                    //Cancer by the Moon;
                    case ZodiacName.Cancer:
                        return PlanetName.Moon;

                    //Leo by the Sun ;
                    case ZodiacName.Leo:
                        return PlanetName.Sun;

                    //Sagittarius and Pisces by Jupiter
                    case ZodiacName.Sagittarius:
                    case ZodiacName.Pisces:
                        return PlanetName.Jupiter;

                    //Capricorn and Aquarius by Saturn.
                    case ZodiacName.Capricornus:
                    case ZodiacName.Aquarius:
                        return PlanetName.Saturn;
                    default:
                        throw new Exception("Lord of sign not found, error!");
                }

            }

        }

        /// <summary>
        /// Gets next zodiac sign after input sign
        /// </summary>
        public static ZodiacName GetNextZodiacSign(ZodiacName inputSign)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetNextZodiacSign", inputSign), _getNextZodiacSign);


            //UNDERLYING FUNCTION
            ZodiacName _getNextZodiacSign()
            {
                //get number of of input zodiac
                int inputSignNumber = (int)inputSign;

                int nextSignNumber;

                //after pieces (12) is Aries (1)
                if (inputSignNumber == 12)
                {
                    nextSignNumber = 1;
                }
                else
                {
                    //else next sign is input sign plus 1
                    nextSignNumber = inputSignNumber + 1;
                }

                //convert next sign number to its zodiac name
                var nextSignName = (ZodiacName)nextSignNumber;

                return nextSignName;

            }
        }

        /// <summary>
        /// Gets next house number after input house number, goes to  1 after 12
        /// </summary>
        public static int GetNextHouseNumber(int inputHouseNumber)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetNextHouseNumber", inputHouseNumber), _getNextHouseNumber);


            //UNDERLYING FUNCTION
            int _getNextHouseNumber()
            {
                int nextHouseNumber;

                //if input house number is 12
                if (inputHouseNumber == 12)
                {
                    //next house number is 1
                    nextHouseNumber = 1;

                }
                else
                {
                    //else next house number is input number + 1
                    nextHouseNumber = inputHouseNumber + 1;
                }


                return nextHouseNumber;

            }

        }

        /// <summary>
        /// Gets the exact longitude where planet is Exaltated/Exaltation
        ///
        /// NOTE:
        /// Rahu & ketu have exaltation points ref : Astroloy for Beginners pg. 12
        /// 
        /// Exaltation
        /// Each planet is held to be exalted when it is
        /// in a particular sign. The power to do good when in
        /// exaltation is greater than when in its own sign.
        /// Throughout the sign ascribed, the planet is exalted
        /// but in a particular degree its exaltation is at the maximum level.
        /// 
        /// </summary>
        public static ZodiacSign GetPlanetExaltationPoint(PlanetName planetName)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetPlanetExaltationPoint", planetName), _getPlanetExaltationPoint);


            //UNDERLYING FUNCTION
            ZodiacSign _getPlanetExaltationPoint()
            {
                //Sun in the 10th degree of Aries;
                if (planetName == PlanetName.Sun)
                {
                    return new ZodiacSign(ZodiacName.Aries, Angle.FromDegrees(10));
                }

                // Moon 3rd of Taurus;
                else if (planetName == PlanetName.Moon)
                {
                    return new ZodiacSign(ZodiacName.Taurus, Angle.FromDegrees(3));
                }

                // Mars 28th of Capricorn ;
                else if (planetName == PlanetName.Mars)
                {
                    return new ZodiacSign(ZodiacName.Capricornus, Angle.FromDegrees(28));
                }

                // Mercury 15th of Virgo;
                else if (planetName == PlanetName.Mercury)
                {
                    return new ZodiacSign(ZodiacName.Virgo, Angle.FromDegrees(15));
                }

                // Jupiter 5th of Cancer;
                else if (planetName == PlanetName.Jupiter)
                {
                    return new ZodiacSign(ZodiacName.Cancer, Angle.FromDegrees(5));
                }

                // Venus 27th of Pisces and
                else if (planetName == PlanetName.Venus)
                {
                    return new ZodiacSign(ZodiacName.Pisces, Angle.FromDegrees(27));
                }

                // Saturn 20th of Libra.
                else if (planetName == PlanetName.Saturn)
                {
                    return new ZodiacSign(ZodiacName.Libra, Angle.FromDegrees(20));
                }

                // Rahu 20th of Taurus.
                else if (planetName == PlanetName.Rahu)
                {
                    return new ZodiacSign(ZodiacName.Taurus, Angle.FromDegrees(20));
                }
                // Ketu 20th of Scorpio.
                else if (planetName == PlanetName.Ketu)
                {
                    return new ZodiacSign(ZodiacName.Scorpio, Angle.FromDegrees(20));
                }

                throw new Exception("Planet exaltation point not found, error!");

            }

        }

        /// <summary>
        /// Gets the exact longitude where planet is Debilitated/Debility
        /// TODO method needs testing!
        /// Note:
        /// -   Rahu & ketu have debilitation points ref : Astroloy for Beginners pg. 12
        /// -   "planet to sign relationship" is the whole sign, this is just a point
        /// -   The 7th house or the 180th degree from the place of exaltation is the
        ///     place of debilitation or fall. The Sun is debilitated-
        ///     in the 10th degree of Libra, the Moon 3rd
        ///     of Scorpio and so on.
        /// -   The debilitation or depression points are found
        ///     by adding 180° to the maximum points given above.
        ///     While in a state of fall, planets give results contrary
        ///     to those when in exaltation. ref : Astroloy for Beginners pg. 11
        /// </summary>
        public static ZodiacSign GetPlanetDebilitationPoint(PlanetName planetName)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetPlanetDebilitationPoint", planetName), _getPlanetDebilitationPoint);


            //UNDERLYING FUNCTION
            ZodiacSign _getPlanetDebilitationPoint()
            {
                //The 7th house or the
                // 180th degree from the place of exaltation is the
                // place of debilitation or fall. The Sun is debilitated-
                // in the 10th degree of Libra, the Moon 3rd
                // of Scorpio and so on.

                //if (planetName == PlanetName.Sun)
                //{
                //    return Angle.FromDegrees(190);
                //}
                //else if (planetName == PlanetName.Moon)
                //{
                //    return Angle.FromDegrees(213);
                //}
                //else if (planetName == PlanetName.Mars)
                //{
                //    return Angle.FromDegrees(118);
                //}
                //else if (planetName == PlanetName.Mercury)
                //{
                //    return Angle.FromDegrees(345);
                //}
                //else if (planetName == PlanetName.Jupiter)
                //{
                //    return Angle.FromDegrees(275);
                //}
                //else if (planetName == PlanetName.Venus)
                //{
                //    return Angle.FromDegrees(177);
                //}
                //else if (planetName == PlanetName.Saturn)
                //{
                //    return Angle.FromDegrees(20);
                //}


                //Sun in the 10th degree of Libra;
                if (planetName == PlanetName.Sun)
                {
                    return new ZodiacSign(ZodiacName.Libra, Angle.FromDegrees(10));
                }

                // Moon 0 of Scorpio
                else if (planetName == PlanetName.Moon)
                {
                    //TODO check if 0 degrees exist
                    return new ZodiacSign(ZodiacName.Scorpio, Angle.FromDegrees(0));
                }

                // Mars 28th of Cancer ;
                else if (planetName == PlanetName.Mars)
                {
                    return new ZodiacSign(ZodiacName.Cancer, Angle.FromDegrees(28));
                }

                // Mercury 15th of Pisces;
                else if (planetName == PlanetName.Mercury)
                {
                    return new ZodiacSign(ZodiacName.Pisces, Angle.FromDegrees(15));
                }

                // Jupiter 5th of Capricorn;
                else if (planetName == PlanetName.Jupiter)
                {
                    return new ZodiacSign(ZodiacName.Capricornus, Angle.FromDegrees(5));
                }

                // Venus 27th of Virgo and
                else if (planetName == PlanetName.Venus)
                {
                    return new ZodiacSign(ZodiacName.Virgo, Angle.FromDegrees(27));
                }

                // Saturn 20th of Aries.
                else if (planetName == PlanetName.Saturn)
                {
                    return new ZodiacSign(ZodiacName.Aries, Angle.FromDegrees(20));
                }

                // Rahu 20th of Scorpio.
                else if (planetName == PlanetName.Rahu)
                {
                    return new ZodiacSign(ZodiacName.Scorpio, Angle.FromDegrees(20));
                }
                // Ketu 20th of Taurus.
                else if (planetName == PlanetName.Ketu)
                {
                    return new ZodiacSign(ZodiacName.Taurus, Angle.FromDegrees(20));
                }


                throw new Exception("Planet debilitation point not found, error!");

            }


        }

        #region SIGN GROUP CALULATORS

        /// <summary>
        /// Returns true if zodiac sign is an Even sign,  Yugma Rasis
        /// </summary>
        public static bool IsEvenSign(ZodiacName planetSignName)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("IsEvenSign", planetSignName), _isEvenSign);


            //UNDERLYING FUNCTION
            bool _isEvenSign()
            {
                if (planetSignName == ZodiacName.Taurus || planetSignName == ZodiacName.Cancer || planetSignName == ZodiacName.Virgo ||
                    planetSignName == ZodiacName.Scorpio || planetSignName == ZodiacName.Capricornus || planetSignName == ZodiacName.Pisces)
                {
                    return true;
                }
                else
                {
                    return false;
                }

            }

        }

        /// <summary>
        /// Returns true if zodiac sign is an Odd sign, Oja Rasis
        /// </summary>
        public static bool IsOddSign(ZodiacName planetSignName)
        {
            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("IsOddSign", planetSignName), _isOddSign);


            //UNDERLYING FUNCTION
            bool _isOddSign()
            {
                if (planetSignName == ZodiacName.Aries || planetSignName == ZodiacName.Gemini || planetSignName == ZodiacName.Leo ||
                    planetSignName == ZodiacName.Libra || planetSignName == ZodiacName.Sagittarius || planetSignName == ZodiacName.Aquarius)
                {
                    return true;
                }
                else
                {
                    return false;
                }

            }


        }

        /// <summary>
        /// Fixed signs- Taurus, Leo, Scropio, Aquarius.
        /// </summary>
        public static bool IsFixedSign(ZodiacName sunSign)
        {
            switch (sunSign)
            {
                case ZodiacName.Taurus:
                case ZodiacName.Leo:
                case ZodiacName.Scorpio:
                case ZodiacName.Aquarius:
                    return true;
                default:
                    return false;
            }

        }

        /// <summary>
        /// Movable signs- Aries, Cancer, Libra, Capricorn.
        /// </summary>
        public static bool IsMovableSign(ZodiacName sunSign)
        {
            switch (sunSign)
            {
                case ZodiacName.Aries:
                case ZodiacName.Cancer:
                case ZodiacName.Libra:
                case ZodiacName.Capricornus:
                    return true;
                default:
                    return false;
            }

        }

        /// <summary>
        /// Common signs- Gemini, Virgo, Sagitarius, Pisces.
        /// </summary>
        public static bool IsCommonSign(ZodiacName sunSign)
        {
            switch (sunSign)
            {
                case ZodiacName.Gemini:
                case ZodiacName.Virgo:
                case ZodiacName.Sagittarius:
                case ZodiacName.Pisces:
                    return true;
                default:
                    return false;
            }

        }


        #endregion


        /// <summary>
        /// Gets a planets permenant relationship.
        /// Based on : Hindu Predictive Astrology, pg. 21
        /// Note:
        /// - Rahu & Ketu are not mentioned in any permenant relatioship by Raman.
        ///   But some websites do mention this. As such Raman's take is taken as final.
        ///   Since there's so far no explanation by Raman on Rahu & Ketu permenant relation it
        ///   is assumed that such relationship is not needed and to make them up for conveniece sake
        ///   could result in wrong prediction down the line.
        ///   But temporary relationship are mentioned by Raman for Rahu & Ketu, so explicitly use
        ///   Temperary relationship where needed.
        /// </summary>
        public static PlanetToPlanetRelationship GetPlanetPermanentRelationshipWithPlanet(PlanetName mainPlanet, PlanetName secondaryPlanet)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetPlanetPermanentRelationshipWithPlanet", mainPlanet, secondaryPlanet), _getPlanetPermanentRelationshipWithPlanet);


            //UNDERLYING FUNCTION
            PlanetToPlanetRelationship _getPlanetPermanentRelationshipWithPlanet()
            {
                //if main planet & secondary planet is same, then it is own plant (same planet), end here
                if (mainPlanet == secondaryPlanet) { return PlanetToPlanetRelationship.SamePlanet; }


                bool planetInEnemies = false;
                bool planetInNeutrals = false;
                bool planetInFriends = false;


                //if main planet is sun
                if (mainPlanet == PlanetName.Sun)
                {
                    //List planets friends, neutrals & enemies
                    var sunFriends = new List<PlanetName>() { PlanetName.Moon, PlanetName.Mars, PlanetName.Jupiter };
                    var sunNeutrals = new List<PlanetName>() { PlanetName.Mercury };
                    var sunEnemies = new List<PlanetName>() { PlanetName.Venus, PlanetName.Saturn };

                    //check if planet is found in any of the lists
                    planetInFriends = sunFriends.Contains(secondaryPlanet);
                    planetInNeutrals = sunNeutrals.Contains(secondaryPlanet);
                    planetInEnemies = sunEnemies.Contains(secondaryPlanet);
                }

                //if main planet is moon
                if (mainPlanet == PlanetName.Moon)
                {
                    //List planets friends, neutrals & enemies
                    var moonFriends = new List<PlanetName>() { PlanetName.Sun, PlanetName.Mercury };
                    var moonNeutrals = new List<PlanetName>() { PlanetName.Mars, PlanetName.Jupiter, PlanetName.Venus, PlanetName.Saturn };
                    var moonEnemies = new List<PlanetName>() { };

                    //check if planet is found in any of the lists
                    planetInFriends = moonFriends.Contains(secondaryPlanet);
                    planetInNeutrals = moonNeutrals.Contains(secondaryPlanet);
                    planetInEnemies = moonEnemies.Contains(secondaryPlanet);

                }

                //if main planet is mars
                if (mainPlanet == PlanetName.Mars)
                {
                    //List planets friends, neutrals & enemies
                    var marsFriends = new List<PlanetName>() { PlanetName.Sun, PlanetName.Moon, PlanetName.Jupiter };
                    var marsNeutrals = new List<PlanetName>() { PlanetName.Venus, PlanetName.Saturn };
                    var marsEnemies = new List<PlanetName>() { PlanetName.Mercury };

                    //check if planet is found in any of the lists
                    planetInFriends = marsFriends.Contains(secondaryPlanet);
                    planetInNeutrals = marsNeutrals.Contains(secondaryPlanet);
                    planetInEnemies = marsEnemies.Contains(secondaryPlanet);

                }

                //if main planet is mercury
                if (mainPlanet == PlanetName.Mercury)
                {
                    //List planets friends, neutrals & enemies
                    var mercuryFriends = new List<PlanetName>() { PlanetName.Sun, PlanetName.Venus };
                    var mercuryNeutrals = new List<PlanetName>() { PlanetName.Mars, PlanetName.Jupiter, PlanetName.Saturn };
                    var mercuryEnemies = new List<PlanetName>() { PlanetName.Moon };

                    //check if planet is found in any of the lists
                    planetInFriends = mercuryFriends.Contains(secondaryPlanet);
                    planetInNeutrals = mercuryNeutrals.Contains(secondaryPlanet);
                    planetInEnemies = mercuryEnemies.Contains(secondaryPlanet);

                }

                //if main planet is jupiter
                if (mainPlanet == PlanetName.Jupiter)
                {
                    //List planets friends, neutrals & enemies
                    var jupiterFriends = new List<PlanetName>() { PlanetName.Sun, PlanetName.Moon, PlanetName.Mars };
                    var jupiterNeutrals = new List<PlanetName>() { PlanetName.Saturn };
                    var jupiterEnemies = new List<PlanetName>() { PlanetName.Mercury, PlanetName.Venus };

                    //check if planet is found in any of the lists
                    planetInFriends = jupiterFriends.Contains(secondaryPlanet);
                    planetInNeutrals = jupiterNeutrals.Contains(secondaryPlanet);
                    planetInEnemies = jupiterEnemies.Contains(secondaryPlanet);

                }

                //if main planet is venus
                if (mainPlanet == PlanetName.Venus)
                {
                    //List planets friends, neutrals & enemies
                    var venusFriends = new List<PlanetName>() { PlanetName.Mercury, PlanetName.Saturn };
                    var venusNeutrals = new List<PlanetName>() { PlanetName.Mars, PlanetName.Jupiter };
                    var venusEnemies = new List<PlanetName>() { PlanetName.Sun, PlanetName.Moon };

                    //check if planet is found in any of the lists
                    planetInFriends = venusFriends.Contains(secondaryPlanet);
                    planetInNeutrals = venusNeutrals.Contains(secondaryPlanet);
                    planetInEnemies = venusEnemies.Contains(secondaryPlanet);

                }

                //if main planet is saturn
                if (mainPlanet == PlanetName.Saturn)
                {
                    //List planets friends, neutrals & enemies
                    var saturnFriends = new List<PlanetName>() { PlanetName.Mercury, PlanetName.Venus };
                    var saturnNeutrals = new List<PlanetName>() { PlanetName.Jupiter };
                    var saturnEnemies = new List<PlanetName>() { PlanetName.Sun, PlanetName.Moon, PlanetName.Mars };

                    //check if planet is found in any of the lists
                    planetInFriends = saturnFriends.Contains(secondaryPlanet);
                    planetInNeutrals = saturnNeutrals.Contains(secondaryPlanet);
                    planetInEnemies = saturnEnemies.Contains(secondaryPlanet);

                }

                //for Rahu & Ketu special exception
                if (mainPlanet == PlanetName.Rahu || mainPlanet == PlanetName.Ketu)
                {
                    throw new Exception("No Permenant Relation for Rahu and Ketu, use Temporary Relation!");
                }




                //return planet relationship based on where planet is found
                if (planetInFriends)
                {
                    return PlanetToPlanetRelationship.Friend;
                }
                if (planetInNeutrals)
                {
                    return PlanetToPlanetRelationship.Neutral;
                }
                if (planetInEnemies)
                {
                    return PlanetToPlanetRelationship.Enemy;
                }


                throw new Exception("planet permanent relationship not found, error!");

            }

        }

        /// <summary>
        /// Converts julian time to normal time, normal time can be lmt, lat, utc
        /// </summary>
        public static DateTime ConvertJulianTimeToNormalTime(double julianTime)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("ConvertJulianTimeToNormalTime", julianTime), _convertJulianTimeToNormalTime);


            //UNDERLYING FUNCTION
            DateTime _convertJulianTimeToNormalTime()
            {
                //initialize ephemeris
                SwissEph ephemeris = new SwissEph();

                //set calender type
                int gregflag = SwissEph.SE_GREG_CAL; //GREGORIAN CALENDAR

                //julian time to normal time
                int year = 0, month = 0, day = 0, hour = 0, min = 0;
                double sec = 0;

                // convert julian time to normal time
                ephemeris.swe_jdut1_to_utc(julianTime, gregflag, ref year, ref month, ref day, ref hour, ref min, ref sec);

                //put pieces of time into one type
                var normalUtcTime = new DateTime(year, month, day, hour, min, (int)sec);

                return normalUtcTime;

            }


        }

        /// <summary>
        /// Gets Greenwich time in normal format from Julian days at Greenwich
        /// Note : Inputed time is Julian days at greenwich, callers reponsibility to make sure 
        /// </summary>
        public static DateTimeOffset GetGreenwichTimeFromJulianDays(double julianTime)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetGreenwichTimeFromJulianDays", julianTime), _convertJulianTimeToNormalTime);


            //UNDERLYING FUNCTION
            DateTimeOffset _convertJulianTimeToNormalTime()
            {
                //initialize ephemeris
                SwissEph ephemeris = new();

                //set calender type
                int gregflag = SwissEph.SE_GREG_CAL; //GREGORIAN CALENDAR

                //prepare a place to receive the time in normal format 
                int year = 0, month = 0, day = 0, hour = 0, min = 0;
                double sec = 0;

                //convert julian time to normal time
                ephemeris.swe_jdut1_to_utc(julianTime, gregflag, ref year, ref month, ref day, ref hour, ref min, ref sec);

                //put pieces of time into one type
                var normalUtcTime = new DateTime(year, month, day, hour, min, (int)sec);

                //set the correct offset (Greenwich = UTC = +0:00)
                var offsetTime = new DateTimeOffset(normalUtcTime, new TimeSpan(0, 0, 0));

                return offsetTime;
            }


        }


        /// <summary>
        /// Gets Local mean time (LMT) at Greenwich (UTC) in Julian days based on the inputed time
        /// </summary>
        public static double GetGreenwichLmtInJulianDays(Time time)
        {

            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetGreenwichLmtInJulianDays", time), _getGreenwichLmtInJulianDays);


            //UNDERLYING FUNCTION
            double _getGreenwichLmtInJulianDays()
            {
                //get LMT time at Greenwich (UTC)
                DateTimeOffset lmtDateTime = time.GetLmtDateTimeOffset().ToUniversalTime();

                //split lmt time to pieces
                int year = lmtDateTime.Year;
                int month = lmtDateTime.Month;
                int day = lmtDateTime.Day;
                double hour = (lmtDateTime.TimeOfDay).TotalHours;

                //set calender type
                int gregflag = SwissEph.SE_GREG_CAL; //GREGORIAN CALENDAR

                //declare output variables
                double localMeanTimeInJulian_UT;

                //initialize ephemeris
                SwissEph ephemeris = new();

                //get lmt in julian day in Universal Time (UT)
                localMeanTimeInJulian_UT = ephemeris.swe_julday(year, month, day, hour, gregflag);//time to Julian Day

                return localMeanTimeInJulian_UT;

            }

        }

        public static double[] GetHouse1And10Longitudes(Time time)
        {
            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("GetHouse1And10Longitudes", time), _getHouse1And10Longitudes);


            //UNDERLYING FUNCTION
            double[] _getHouse1And10Longitudes()
            {
                //get location at place of time
                var location = time.GetGeoLocation();

                //Convert DOB to Julian Day
                var jul_day_UT = TimeToJulianDay(time);

                SwissEph swissEph = new SwissEph();

                double[] cusps = new double[13];
                //we have to supply ascmc to make the function run
                double[] ascmc = new double[10];

                swissEph.swe_houses(jul_day_UT, location.GetLatitude(), location.GetLongitude(), 'P', cusps, ascmc);

                //we only return cusps, cause that is what is used for now
                return cusps;
            }

            //special function localized to allow caching
            //note: there is another version that does caching
            double TimeToJulianDay(Time time)
            {
                //get lmt time
                var lmtDateTime = time.GetLmtDateTimeOffset();

                //Converts LMT to UTC (GMT)
                DateTimeOffset utcDateTime = lmtDateTime.ToUniversalTime();

                SwissEph swissEph = new SwissEph();

                double jul_day_UT;
                jul_day_UT = swissEph.swe_julday(utcDateTime.Year, utcDateTime.Month, utcDateTime.Day,
                    utcDateTime.TimeOfDay.TotalHours, SwissEph.SE_GREG_CAL);
                return jul_day_UT;

            }



        }

        [API("UTC")]
        public static DateTimeOffset LmtToUtc(Time time)
        {
            //CACHE MECHANISM
            return CacheManager.GetCache(new CacheKey("LmtToUtc", time), _lmtToUtc);


            //UNDERLYING FUNCTION
            DateTimeOffset _lmtToUtc()
            {
                return time.GetLmtDateTimeOffset().ToUniversalTime();
            }
        }

        #endregion


        #region Gochara Calculations

        /// <summary>
        /// Gets the Gochara House number which is the count from birth Moon sign (janma rasi)
        /// to the sign the planet is at the current time. Gochara == Transits
        /// </summary>
        public static int GetGocharaHouse(Time birthTime, Time currentTime, PlanetName planet)
        {
            //get moon sign at birth (janma rasi)
            var janmaSign = AstronomicalCalculator.GetMoonSignName(birthTime);

            //get planet sign at input time
            var planetSign = AstronomicalCalculator.GetPlanetRasiSign(planet, currentTime).GetSignName();

            //count from janma to sign planet is in
            var count = AstronomicalCalculator.CountFromSignToSign(janmaSign, planetSign);

            return count;
        }

        /// <summary>
        /// Check if there is an obstruction to a given Gochara
        /// </summary>
        public static bool IsGocharaObstructed(PlanetName planet, int gocharaHouse, Time birthTime, Time currentTime)
        {

            //get the obstructing house/point (Vedhanka) for the inputed Gochara house
            var vedhanka = GetVedhanka(planet, gocharaHouse);

            //if vedhanka is 0, then end here as no obstruction
            if (vedhanka == 0) { return false; }

            //get all the planets transiting (gochara) in this obstruction point/house (vedhanka)
            var planetList = GetPlanetsInGocharaHouse(birthTime, currentTime, gocharaHouse);

            //remove the exception planets
            //No Vedha occurs between the Sun and Saturn, and the Moon and Mercury.
            if (planet == PlanetName.Sun || planet == PlanetName.Saturn)
            {
                planetList.Remove(PlanetName.Sun);
                planetList.Remove(PlanetName.Saturn);
            }
            if (planet == PlanetName.Moon || planet == PlanetName.Mercury)
            {
                planetList.Remove(PlanetName.Moon);
                planetList.Remove(PlanetName.Mercury);
            }

            //now if any planet is found in the list, than obstruction is present
            return planetList.Any();

        }

        /// <summary>
        /// Gets all the planets in a given Gochara House
        /// 
        /// Note : Gochara House number is the count from birth Moon sign (janma rasi)
        /// to the sign the planet is at the current time. Gochara == Transits
        /// </summary>
        public static List<PlanetName> GetPlanetsInGocharaHouse(Time birthTime, Time currentTime, int gocharaHouse)
        {
            //get the gochara house for every planet at current time
            var gocharaSun = GetGocharaHouse(birthTime, currentTime, PlanetName.Sun);
            var gocharaMoon = GetGocharaHouse(birthTime, currentTime, PlanetName.Moon);
            var gocharaMars = GetGocharaHouse(birthTime, currentTime, PlanetName.Mars);
            var gocharaMercury = GetGocharaHouse(birthTime, currentTime, PlanetName.Mercury);
            var gocharaJupiter = GetGocharaHouse(birthTime, currentTime, PlanetName.Jupiter);
            var gocharaVenus = GetGocharaHouse(birthTime, currentTime, PlanetName.Venus);
            var gocharaSaturn = GetGocharaHouse(birthTime, currentTime, PlanetName.Saturn);

            //add every planet name to return list that matches input Gochara house number
            var planetList = new List<PlanetName>();
            if (gocharaSun == gocharaHouse) { planetList.Add(PlanetName.Sun); }
            if (gocharaMoon == gocharaHouse) { planetList.Add(PlanetName.Moon); }
            if (gocharaMars == gocharaHouse) { planetList.Add(PlanetName.Mars); }
            if (gocharaMercury == gocharaHouse) { planetList.Add(PlanetName.Mercury); }
            if (gocharaJupiter == gocharaHouse) { planetList.Add(PlanetName.Jupiter); }
            if (gocharaVenus == gocharaHouse) { planetList.Add(PlanetName.Venus); }
            if (gocharaSaturn == gocharaHouse) { planetList.Add(PlanetName.Saturn); }

            return planetList;
        }

        /// <summary>
        /// Gets the Vedhanka (point of obstruction), used for Gohchara calculations.
        /// The data returned comes from a fixed table. 
        /// NOTE: - Planet exceptions are not accounted for here.
        ///       - Return 0 when no obstruction point exists 
        /// Reference : Hindu Predictive Astrology pg. 257
        /// </summary>
        public static int GetVedhanka(PlanetName planet, int house)
        {
            //filter based on planet
            if (planet == PlanetName.Sun)
            {
                //good
                if (house == 11) { return 5; }
                if (house == 3) { return 9; }
                if (house == 10) { return 4; }
                if (house == 6) { return 12; }
                //bad
                if (house == 5) { return 11; }
                if (house == 9) { return 3; }
                if (house == 4) { return 10; }
                if (house == 12) { return 6; }
            }

            if (planet == PlanetName.Moon)
            {
                //good
                if (house == 7) { return 2; }
                if (house == 1) { return 5; }
                if (house == 6) { return 12; }
                if (house == 11) { return 8; }
                if (house == 10) { return 4; }
                if (house == 3) { return 9; }
                //bad
                if (house == 2) { return 7; }
                if (house == 5) { return 1; }
                if (house == 12) { return 6; }
                if (house == 8) { return 11; }
                if (house == 4) { return 10; }
                if (house == 9) { return 3; }

            }

            if (planet == PlanetName.Mars)
            {
                //good
                if (house == 3) { return 12; }
                if (house == 11) { return 5; }
                if (house == 6) { return 9; }
                //bad
                if (house == 12) { return 3; }
                if (house == 5) { return 11; }
                if (house == 9) { return 6; }
            }

            if (planet == PlanetName.Mercury)
            {
                //good
                if (house == 2) { return 5; }
                if (house == 4) { return 3; }
                if (house == 6) { return 9; }
                if (house == 8) { return 1; }
                if (house == 10) { return 7; }
                if (house == 11) { return 12; }

                //bad
                if (house == 5) { return 2; }
                if (house == 3) { return 4; }
                if (house == 9) { return 6; }
                if (house == 1) { return 8; }
                if (house == 7) { return 10; }
                if (house == 12) { return 11; }
            }

            if (planet == PlanetName.Jupiter)
            {
                //good
                if (house == 2) { return 12; }
                if (house == 11) { return 8; }
                if (house == 9) { return 10; }
                if (house == 5) { return 4; }
                if (house == 7) { return 3; }

                //bad
                if (house == 12) { return 2; }
                if (house == 8) { return 11; }
                if (house == 10) { return 9; }
                if (house == 4) { return 5; }
                if (house == 3) { return 7; }

            }

            if (planet == PlanetName.Venus)
            {
                //good
                if (house == 1) { return 8; }
                if (house == 2) { return 7; }
                if (house == 3) { return 1; }
                if (house == 4) { return 10; }
                if (house == 5) { return 9; }
                if (house == 8) { return 5; }
                if (house == 9) { return 11; }
                if (house == 11) { return 6; }
                if (house == 12) { return 3; }

                //bad
                if (house == 8) { return 1; }
                if (house == 7) { return 2; }
                if (house == 1) { return 3; }
                if (house == 10) { return 4; }
                if (house == 9) { return 5; }
                if (house == 5) { return 8; }
                if (house == 11) { return 9; }
                if (house == 6) { return 11; }
                if (house == 3) { return 12; }

            }

            if (planet == PlanetName.Saturn)
            {
                //good
                if (house == 3) { return 12; }
                if (house == 11) { return 5; }
                if (house == 6) { return 9; }

                //bad
                if (house == 12) { return 3; }
                if (house == 5) { return 11; }
                if (house == 9) { return 6; }

            }
            //copy of saturn & mars
            if (planet == PlanetName.Rahu)
            {
                //good
                if (house == 3) { return 12; }
                if (house == 11) { return 5; }
                if (house == 6) { return 9; }

                //bad
                if (house == 12) { return 3; }
                if (house == 5) { return 11; }
                if (house == 9) { return 6; }

            }
            if (planet == PlanetName.Ketu)
            {
                //good
                if (house == 3) { return 12; }
                if (house == 11) { return 5; }
                if (house == 6) { return 9; }

                //bad
                if (house == 12) { return 3; }
                if (house == 5) { return 11; }
                if (house == 9) { return 6; }

            }





            //if no condition above met, then there is no obstruction point
            return 0;
        }

        /// <summary>
        /// Checks if a Gochara is occuring for a planet in a given house without any obstructions at a given time
        /// Note : Basically a wrapper method for Gochra event calculations
        /// </summary>
        public static bool IsGocharaOccurring(Time birthTime, Time time, PlanetName planet, int gocharaHouse)
        {
            //check if planet is in the specified gochara house
            var planetGocharaMatch = AstronomicalCalculator.GetGocharaHouse(birthTime, time, planet) == gocharaHouse;

            //check if there is any planet obstructing this transit prediction via Vedhasthana
            var obstructionNotFound = !AstronomicalCalculator.IsGocharaObstructed(planet, gocharaHouse, birthTime, time);

            //occuring if all conditions met
            var occuring = planetGocharaMatch && obstructionNotFound;

            return occuring;
        }

        #endregion


        #region Dasa Calcuations

        /// <summary>
        /// Gets the relationship between a mojor period planet and minor period planet based solely on relationship between
        /// the planets and nothing to do with the signs yet
        /// based on cyclic relationship between planets
        /// </summary>
        public static (EventNature eventNature, string desciption) GetPlanetDasaMajorPlanetAndMinorRelationship(PlanetName majorPlanet, PlanetName minorPlanet)
        {
            //------ Code Poetry ------
            // lets take a moment to appreciate this piece of code
            // it represents mathematically the nueral patern inside the human brain
            // what the brain once did, is now done below
            //-------------------------

            //create place to fill the data in & to detect if null
            var returnVal = (eventNature: EventNature.Empty, desciption: "");

            switch (majorPlanet.Name)
            {
                case PlanetName.PlanetNameEnum.Sun:
                    {
                        switch (minorPlanet.Name)
                        {
                            case PlanetName.PlanetNameEnum.Sun:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Unpleasantness with relatives and superiors, anxieties, headache, pain in the ear, some tendency to urinary or kidney troubles, sickness, fear from rulers and enemies, fear of death, loss of money, danger to father if the Sun is afflicted, stomachache and travels, gains through religious people, mental sufferings, a wandering life in a foreign country.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Moon:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Winning favour from superiors, increase in business, fresh enterprises, troubles through women, eye troubles, many relatives and friends, indulgence in idle pastimes, jaundice and kindred ailments, new clothes and ornaments, will be happy, healthy, good meals, respect among relatives.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mars:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Rheumatic and similar troubles, quarrels, danger of enteric fever, dysentery, troubles to relatives, loss of money by thefts or wasteful expenses, failures, acquisition of wealth in the form of gold and gems, royal favour leading to prosperity, contraction and transmission of bilious and other diseases, mental worries, danger from fire, ill-health, loss of reputation, sorrow.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mercury:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Gain in money, good reputation, acquisition of new clothes and ornaments, new education, trouble through relatives, mental distress, depression of spirits, waste of money and nervous weakness, no comforts, friends becoming enemies, much anxiety and fears, health bad, children ungrateful, disputes and trouble from ruler or judge, suffer disgrace, many short journeys and wanderings.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Jupiter:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Benefits from friends and acquaintances, increase in education, employment in high circles, association with people of high rank, success through obstacles, birth of a child, wealth got through sons (if there is a son), honour to religious people, virtuous acts, good traditional observances, good society and conversations, reputation, gains and court-honours.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Venus:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Gain of money, respect by rulers and gain of vehicles, likelihood of marriage, increase of property, illness, does many good works, acquisition of pearls or other precious stones, fatigue, addiction to immoral females and profitless discussions.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Saturn:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Constant sickness to family members, new enemies, some loss of property, bodily ailment, much unhappiness, displacement from home accidents, quarrels with relatives, loss of money, disease, lacking in energy, ignoble calls, mental worries, loans, danger from thieve and rulers.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Rahu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Many troubles, changes according to the position of Rahu, family disputes, journeys, fear of death, trouble from relatives and enemies, loss of peace or mental misery, loss of money, sorrows, unsuccessful in all attempts, fear of thieves and reptiles, scandals.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Ketu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Loss of money, affliction of mind with troubles, fainting or nervous exhaustion, mind full of misgivings, a long journey to a distant place, change of house due to disputes, troubles among relatives and associates, throat disease, mental anguish, ophthalmia, serious illness, fear from kings or rulers and enemies, diseases, cheated by others.";
                                    return returnVal;
                                }
                            default:
                                {
                                    throw new Exception($"Planet not accounted for! : {minorPlanet}");
                                }
                        }
                    }
                case PlanetName.PlanetNameEnum.Moon:
                    {
                        switch (minorPlanet.Name)
                        {
                            case PlanetName.PlanetNameEnum.Sun:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Feverish complaints, pains in the eyes, success or failure according to position of the Sun and the Moon, legal power, free from diseases, decadence of enemies, happiness and prosperity, jaundice, dropsy, fever, loss of money, travels, danger to father and mother, piles, weakness, loss of children and friends.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Moon:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Devoted attention to learning, love or music, good clothing, company of refined society, sound health, good reputation, journey to holy places, acquisition of abandoned wealth, power, vehicles and lands; marriage, relatives, fortunate deeds, inclination to public life, change of residence, birth of a child, increase of wealth, prosperity to relatives.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mars:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Quarrels and litigation among friends and relatives, headlong enterprises, danger of disputes between husband and wife, between lovers or in regard to marital affairs; disease, petulence, loss of money, waste of wealth, trouble from brothers and friends, danger from fever and fire, injury from instruments or stones, loss of blood and disease to household animals.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mercury:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Acquisition of wealth from maternal relatives, new clothes and ornaments, settlement of disputes, pleasure through children or lover, increase of wealth, accomplishment of desires, intellectual achievements, new education, honour from rulers, general happiness, enjoyment with females, addiction to betting and drinks.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Jupiter:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Increase of property, plenty of food and comforts, prosperous, benefits from superiors such as masters or governors, birth. of a child, vehicles, abundance of clothes and ornaments and success in undertakings, patronage or rulers, gain or property, respect, learned.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Venus:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Sudden gain from wife, enjoys comforts of agriculture, water products and clothing, suffers from diseases inherited by mother, sickness, pain, loss of property, enmity, gain of houses, good works and good meals, birth of children, expenses due to marriage or other auspicious acts.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Saturn:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Wife's death or separation, much mental anguish, loss of property, loss of friends, ill health, mental trouble due to mother, wind and bilious affections, harsh words, and discussion with unfriendly people, disease due to indigestion, no peace of mind, quarrels with relatives.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Rahu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Distress of risks from falls and dangerous diseases, waste of wealth and loss of relatives and no ease to body, loss of money, danger of stirring up enemies, sickness, anxiety, enmity of superiors and elders, anxiety and troubles through wife, scandals, change of residence, diseases of skin, danger from thieves and poison, ill-health to father and mother, suffering from hunger.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Ketu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Illness to wife, loss of relatives, suffering from stomach ache, loss or property, sickness of a feverish nature, danger from fire, subject to swellings or eruptions, eye troubles, mind filled with cares, public criticism or displeasure, dishonor, danger to father, mother and children, scandals among equals, eating of prohibited food, bad acts, bad company, loss of money and memory.";
                                    return returnVal;
                                }
                            default:
                                throw new Exception($"Planet not accounted for! : {minorPlanet}");
                        }
                    }
                case PlanetName.PlanetNameEnum.Mars:
                    {
                        switch (minorPlanet.Name)
                        {
                            case PlanetName.PlanetNameEnum.Sun:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Gain of money in bad ways, destruction of enemies, good reputation, long journey to foreign lands and peace of mind, blame, odium of ciders, quarrels with them, sufferings by diseases, heartache occasioned by one's own relatives, fever or other inflammatory affection, danger of fire, troubles through persons in position, many enemies.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Moon:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Profit, acquisition of wealth, house renovated or some improvements effected in it, comforts of wealth, heavy sleep, ardent passion, enjoyment by the help or women.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mars:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Great heat, dislike of friends, annoyance from brothers and sisters, danger from rulers, failure of all undertakings, danger of hurts according to the sign held by Kuja, trouble with superiors and some anxiety through strangers, foreigners or people abroad and through warlike clan. Danger of open violence, quarrel with relations, loss of money, skin disease, consumption, loss of blood, fistula, and fissures in anus, loss of females and brothers, evil doings and boils.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mercury:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Marriage or inclination to marriage, knowledge and fruits of knowledge, wealth, bodily evils disappear, slander, fear of insects, poisoned by animals and insects, gain of wealth by trade, abundance of houses, trouble from enemies and mental worries, service rendered to friends and relatives, new knowledge, success in litigation.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Jupiter:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Loss of wealth, enemies, end the unfortunate period, favour from superiors and persons in position, gain of money, birth of children, auspicious celebrations, acquisition or wealth through holy people, freedom from illness, public reputation, ascendancy and happiness.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Venus:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Acquisition of property, gain of money, domestic happiness, successful love affairs, inclination towards religious observances and festivities, favourable associations, influenced by priests, skin eruptions, boils, pleasure from travelling, jewels to wife, clothing, money from relatives and brothers, odium.of females and their society, increase of intelligence, enjoyment of females and gain of money.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Saturn:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Loss of money, diseases, loss of relatives and danger from arms or operation, illness leading to misery, evil threatened by enemies and robbers, disputes with rulers, loss of wealth, quarrel, disputes, litigation, loss of property, cutaneous effects. loss of office or position and much anxiety.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Rahu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Danger from rulers and robbers, loss of wealth, success in evil pursuits, suffering from poisonous complaints, loss of relatives, danger from skin diseases, change of residence, some severe kind of cutaneous disease, journey to a foreign country, scandals, loss of cows and buffaloes, illness to wife, loss of memory, fear from insects and thieves, falls into well, fear from ghosts, affection of gonorrhea, fretting and";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Ketu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Enmity and quarrels with low people, loss of money due to evil works, commission of signs, great sufferings due to troubles from relatives and brothers and opposition of bad people, family disputes, troubles with one's own kindred diseases, poisonous complaints, trouble through women, many enemies.";
                                    return returnVal;
                                }
                            default:
                                throw new Exception($"Planet not accounted for! : {minorPlanet}");
                        }
                    }
                case PlanetName.PlanetNameEnum.Mercury:
                    {
                        switch (minorPlanet.Name)
                        {
                            case PlanetName.PlanetNameEnum.Sun:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Pains in bead and stomach, enmity of people, loss of respect, danger of fire, anxieties, sickness to wire, troubles from enemies, many obstacles, troubles through superiors, acquisition of wealth.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Moon:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Loss of health, some swellings or hurts in the limbs, quarrels and troubles through women, many difficulties, gain of money through ladies and agriculture and trade, success, happiness, diseases, ill-will of enemies, miscarriage of every concern, risk from quadrupeds.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mars:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Disappearance of all dangers diseases or enemies, fame derived from acts of charity and beneficence, royal favour, danger from jaundice or bilious fever, affections of the blood, neuralgic pains and headaches, troubles through neighbors, sickness, wounds or hurts, quarrels, addiction to drinks, betting and prostitutes, boils and hurts of arms, travels in forests and villages, sorrows, royal disfavour, imprisonment.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mercury:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Acquisition of beautiful house and apparel, money through relatives, success in every undertaking, the birth of a brother or sister, increase in family, gain in business, good mind charitable acts, learning of mathematics and arts.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Jupiter:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Hatred of friends, relatives and elders, wealth, liable to diseases, acquisition of land and wealth, gain by trade, reputation, good happiness, good credit, benefits from superiors, birth of a child or marriage.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Venus:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Observance of duty, conformable to religion and morality, acquisition of wealth, clothes and jewels, birth or good children, happiness in married state, relatives prosper, trade increases, knowledge gained, return from a long journey, if not married, betrothal in this period, health, ornaments, vehicles, house, money gained.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Saturn:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Bad luck. stranger to success and happiness, severe reversal, enmity, pain in the part governed by Saturn, downfall or disgrace to relatives, mind full of evil forebodings and distress. rear from diseases, loans, loss of children, destruction of family, scandals, troubles from foreigners, earnings through evil ways, acts of charity and beneficence, acquisition of wealth, material comforts through petty chiefs, failure in agricultural operations.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Rahu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Intercourse with servants and prostitutes, skin diseases, sufferings from hot diseases, bad company and dirty meals. change or present position, fear and danger through foreigners, disputes concerning property, failure in litigation, evil dreams. headaches, sickness and loss of appetite. wealth from friends and relatives, happiness, new earnings.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Ketu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Sorrow, disease, loss of work and Dharma, bilious sickness, aimless wandering, loss of property, misfortune to relatives, troubles through doctors, mental anxiety, trouble from relatives, mental agony, loss of comfort, dread of enemy, failure in business.";
                                    return returnVal;
                                }
                            default:
                                throw new Exception($"Planet not accounted for! : {minorPlanet}");
                        }
                    }
                case PlanetName.PlanetNameEnum.Jupiter:
                    {
                        switch (minorPlanet.Name)
                        {
                            case PlanetName.PlanetNameEnum.Sun:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Enemies, victory, ease, great diligence, coming in of wealth, royal favour and sound health, gain,good actions or fruits of good action, loss of bodily strength.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Moon:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Increase of prosperity, gain of fame and fortune, acquisition or property, benefits through children, sexual intercourse with beautiful women, good meals and clothing, success and birth or a female child or marriage to some male member in the family, gain of money.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mars:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Disappointments and troubles of various kinds, loss by thefts, loss of near and dear relatives, inflammatory disease, transfer or leave, failure in hopes and business, wandering, high fever, great risks, loss of wealth and depression of mind, pilgrimage to temples, acquisition of wealth and fame, adventures.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mercury:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Increase of wealth, good and auspicious works in the house, communion with relatives, happy, increase of knowledge, acquisition of wealth through trade, favour from rulers, material comforts, perfect practice of hospitality, gain through knowledge in fine arts, birth of a well-favoured child, advantages from superiors.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Jupiter:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Increase of property, domestic happiness, benefit from employment or occupation, birth of children, reputation, good meals, good deeds, health. royal favour, great diligence, success in all attempts, travels, dips in sacred rivers, pilgrimage, honour at stake if afflicted.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Venus:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Appointment, wealth, reputation, gain of money, savings, development of sons and grandsons, jewels, good and delicious meals, marital happiness, auspicious works, reunion of the family, good success in profession or business, gain of land in the month of Taurus or Libra, much enjoyment, relatives, friends, peace or mind, acquisition or valuables, troubles from females and odium of public.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Saturn:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"A feeling of aversion, mental anguish, waste of wealth through sons, failure of business, increase of wealth and prosperity, pain in the body, rheumatic pains in limbs, trouble through wife or partners, failure in profit and credit, sorrows, fears, enmity of friends and relatives, adultery, unrighteous, a witness in court, quarrels in family, mental depression, funeral ceremonies for others,";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Rahu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Income through low-caste people, apprehension of diseases, possibility of every possible calamity, deprivation of wealth.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Ketu:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Pilgrimages to holy shrines, increase of wealth, suffering for the sake of several seniors and rulers, death of partner if in business, change of residence, separation from relatives and friends, may forsake business, poisonous effects, loss of wealth, destruction of work, illness, boils.";
                                    return returnVal;
                                }
                            default:
                                throw new Exception($"Planet not accounted for! : {minorPlanet}");
                        }
                        break;
                    }
                case PlanetName.PlanetNameEnum.Venus:
                    {
                        switch (minorPlanet.Name)
                        {
                            case PlanetName.PlanetNameEnum.Sun:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Anxious about everything, prosperity collapses, troubles with wife, children, land, family, disputes and quarrels, diseases affecting head, belly and eyes, damage in respect of agriculture.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Moon:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Gains of females, education, knowledge, money, children and vehicles, worship of God, accomplishments of desires, troubles through wife, domestic happiness afterwards, pain and disease due to inflammation of nervous tissue and from lust and other passions of human nature.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mars:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Flow of bile, disease of the eyes, great exertion, much income, acquisition or wealth, marriage, acquisition of lands, venereal diseases, danger from arms, exile in foreign places, atheistic tendencies, increase of property through the influence of females, negligence of duty, bent on pleasure and passion, temporary affection of eyes.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mercury:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Association with prostitutes, enjoyments, knowledge, mathematical learning, success in litigations, inclination to learn music, piles and other hot ailments, pleasure through wife and children, increase of wealth, gain of knowledge in aru and sciences, wealth, royal favour, prosperity on a large scale and sound health.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Jupiter:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Means of livelihood settled, gains from profession, benefits through superiors or employers or persons ruled by Jupiter fame, anxiety, quarrels with saints and religious men, gain of knowledge, end of dependence, worship of certain inferior natural forces, happiness and health, marriages, sexual intercourse, increase of family reputation and good deeds, wealth. ultimate happiness, wife and children suffer in the end.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Venus:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Success, good servants and good many pleasures, money plentiful. disappearance of enemies, attainment of fame and birth of children.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Saturn:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Sexual intercourse with females advanced in age, accession to lands and wealth, disappearance of enemies, affection of excretory system, piles, etc., rheumatic pains in legs and bands, danger to eye sight, distaste for food, loss of appetite, physical condition poor, loss of money, wanderings, servitude, bolting and gambling, addiction to liquor, bad company, etc., ill-health, loss of memory, impotence.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Rahu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Meditation, seclusion, quarrels among relatives and his people, entire change of surroundings, schemes of deception. miserliness, acquisition of lost property, dislike of relatives. evil from friends and injury by fire.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Ketu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Discordance, death of relatives, injury inflicted by enemies, misgivings in heart, deprivation of wealth, troubles through wife, danger from quadrupeds, illness to partner or a member of the family, accidental blood poisoning, delirious fits, weakness in body and mind, gradual loss of wealth, loss of relatives, bad company, abode in seclusion, manifold sorrows, but happiness in the end.";
                                    return returnVal;
                                }
                            default:
                                throw new Exception($"Planet not accounted for! : {minorPlanet}");
                        }
                    }
                case PlanetName.PlanetNameEnum.Saturn:
                    {
                        switch (minorPlanet.Name)
                        {
                            case PlanetName.PlanetNameEnum.Sun:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Loss of wife and children, trouble from rulers or robbers. sinking of heart, danger of blood poisoning, haemorrhage of the generative system, chronic poisoning, intestinal swellings, affliction of the eyes, sickness even to healthy children and wife, body full of pain and disorders, danger of death. fear of death to father-in-law.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Moon:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Increase in cattle, enmity of friends and relatives, cold affections, troubles and sickness, family disputes, loss of money and property, reduction to great need, mortgage of property and its recovery after a lapse of time, death of a near relative, sorrow, dislike of relatives, coming in of money, windy diseases.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mars:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Some disgrace, serious enmity, strife, much blame, wanderings from place to place, unsettled life, many enemies, loss of money by fraud or theft, change of residence, serious illness, distress to brothers and friends, hot diseases.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mercury:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Charitable works, gain of wealth, birth of children, increase of knowledge in some branch, prosperity to children, success to relatives, general prosperity, favours and approbation from superiors, increase of happiness, wealth and fame, benefits occurring from acts of piety and customary religious observances, agriculture and commerce.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Jupiter:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Worship of gods and holy people, happiness to family, increase in bodily comforts, accomplishment of intentions by the help of superiors, increase of family circles, attainment of rank.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Venus:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Auspicious, general happiness, attentions and favours from others, gifts, profits in business, increase of family members, victory over enemies, success in life, goodwill of relatives, accession to wife's property and wealth.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Saturn:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Brings on diseases, troubles and torments, much mental anguish, capacity of kings and free-hooters, loss of wealth, fear or poisonous effect to cattle, much sufferings to family, fever, wind or phlegm, bodily ailments and colic, body languishes, loss of money and children, serious enmities, dispute and troubles from relatives, blood and bilious complaints, quarrels in family, loss of money, mental derangement.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Rahu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Disease in every limb, loss of wealth by rulers, robbers and foes, danger of physical hurts, various physical troubles, fevers, enemies, increase of troubles.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Ketu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Rheumatism or sickness, danger of poison, danger from sons, loss of money, contentions and quarrels with vile and wicked people, dread of evil dreams, quarrels in family.";
                                    return returnVal;
                                }
                            default:
                                throw new Exception($"Planet not accounted for! : {minorPlanet}");
                        }
                    }
                case PlanetName.PlanetNameEnum.Rahu:
                    {
                        switch (minorPlanet.Name)
                        {
                            case PlanetName.PlanetNameEnum.Sun:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Hot fevers, giddiness, fear and enmity of people, quarrels in family, benefits from persons in good position, fear and suspicion in connection with wife, children and relatives, change of position or residence, love of charitable acts, contentment, cessation of all violence and outrage of contagious diseases, success in examinations, private life happy, much reputation and fame, but mental unrest.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Moon:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Abundance of enjoyments, good crops, coming in of money and communion with kith and kin, loss of relatives, loss of money through wife, pains in the limbs, change of position or residence, danger of personal hurts, unstability of health, sea voyages, gain of lands and money, loss or danger to wife and children.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mars:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Danger from rulers, fires or thieves and by arms, defeat in litigation, loss of money due to cousins, difficulties, sorrows, danger to the person due to malice of enemies, tendency to ease or dissolute habits, disputes and mental anxiety, combination of all possible calamities, bewilderment in every work and culpable failure of memory.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mercury:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Many friends and relatives, wife and children, accession to wealth or royal favour. In the first 18 months of this period very busy, seriously inclined to marry. In the latter 12 months, enemies increase through his own action, happiness, birth of children, acquisition of vehicles, happiness to relatives and family, enjoyments with prostitutes, showy, gains through trade, fraudulent schemes.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Jupiter:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Total disappearance of enemies and sickness, royal favour, acquisition of wealth, birth of children, increase of pleasure, gain through nobles or persons in power, benefits and comforts from superiors, success in all efforts, marriage in the house, increase of enemies, litigations and dips in sacred rivers.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Venus:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Accession to vehicles and things of foreign land, troubles from foes, relatives and diseases, acquisition of wealth and other advantages, friendly alliances, wife a source of fortune and happiness, benefits from superiors or beads above in office, liable to deception, false friends, gain in land, birth of a child or marriage.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Saturn:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Scandal, danger due to fall of a tree, bad associations, divorce of wife or husband, incessant disputes and contests, rheumatism, biliousness, etc., throughout: disease due to wind and bile, distress of relatives, friends and well-wishers, residence in a remote foreign land.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Rahu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Disturbance in mind, anxieties, quarrels among relatives, death of partner, master or the head of the family, mental anxiety, danger of poisoning, transfer, all sorts of scandals and quarrels, fever, bites of insects or wounds by arms, death of relatives, going to court as witness, quarrels with parents, diseases, illness to wife, failure of intellect, loss of wealth, wandering in far-off countries and distress there.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Ketu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Danger, disease in the anus, no good and timely meals, epidemic diseases, danger of physical hurts and poison, ill-health to children, some swellings in the body, troubles through wife, danger from superiors, loss of wealth and honour, loss of children, death of cattle and misfortunes of all kinds.";
                                    return returnVal;
                                }
                            default:
                                throw new Exception($"Planet not accounted for! : {minorPlanet}");
                        }
                    }
                case PlanetName.PlanetNameEnum.Ketu:
                    {
                        switch (minorPlanet.Name)
                        {
                            case PlanetName.PlanetNameEnum.Sun:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Disappointment, physical pain, exile in foreign country, peril and obstruction in every business, increase of knowledge, sickness in family, long journey and return, anxiety about wife's health.";
                                    break;
                                }
                            case PlanetName.PlanetNameEnum.Moon:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Disputes about fair sex, trouble through children, gains and financial success, diseases of biliousness and cold, loss of relatives and money, destruction of wealth and distress of mind.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mars:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Odium of sons, wife and younger brothers, loss of relatives, trouble from diseases, foes and bad rulers, path of progress obstructed, fear and anxiety, disputes and contests of different kinds, enemies arise, danger of disputes and destruction through females, sufferings from fever, fear of robbers, death, imprisonment, urinary diseases, loss and difficulties and surgical operations.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Mercury:
                                {
                                    returnVal.eventNature = EventNature.Neutral;
                                    returnVal.desciption = @"Society of relatives, friends and the like, material gains from knowledge, danger from relatives, anxiety on account of children, failure in plans, deception, jealousy, falsehood, and knowledge.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Jupiter:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Exemption from ailments, acquisition of lands and birth of children, profitable transactions, association with people of good position, danger of poison, wife an object of pleasure, if unmarried marriage takes place.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Venus:
                                {
                                    returnVal.eventNature = EventNature.Good;
                                    returnVal.desciption = @"Wealth and happiness, birth of a child, efforts crowned with success, in the end sickness, wife ill, illness to children, quarrels, loss of relatives and friends, fever and dysentery.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Saturn:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Loss of wife, danger from enemies, imprisonment, loss of wealth, indigestion, property in danger or ruin, heavy loss in different ways, change of residence, some cutaneous diseases. anxiety owing to sickness of partner misgivings in the heart, mental anguish, difference of opinion with relations, exile in foreign countries.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Rahu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Loss of lands, imprisonment, quarrel with friends, danger of blood poisoning, danger of ruin, loss of property, fame and honour, rear of kings and robbers, sorrow, ruin of all business, adultery with mean women.";
                                    return returnVal;
                                }
                            case PlanetName.PlanetNameEnum.Ketu:
                                {
                                    returnVal.eventNature = EventNature.Bad;
                                    returnVal.desciption = @"Fear of death of wife or children, loss of wealth and happiness, mental troubles, separation from relatives, subject to some estrangement, restraint or detention, danger of poison.";
                                    return returnVal;
                                }
                            default:
                                throw new Exception($"Planet not accounted for! : {minorPlanet}");
                        }
                    }
                    break;
                default:
                    throw new Exception($"Planet not accounted for! : {majorPlanet}");
            }

            //return the specialized nature & description packaged together
            return returnVal;
        }

        public static int GetCurrentDasaCountFromBirth(Time birthTime, Time currentTime)
        {
            //get dasa planet at birth (birth time = current time)
            var birthDasaPlanet = GetCurrentDasaBhuktiAntaram(birthTime, birthTime).Dasa;

            var currentDasaPlanet = GetCurrentDasaBhuktiAntaram(birthTime, currentTime).Dasa;


            //count from birth dasa planet to current dasa planet
            var dasaCount = 1; //minimum 1

            //start with birth dasa planet,
            //incase current & birth dasa planet is same
            PlanetName nextPlanet = birthDasaPlanet;

        TryAgain:
            //planet found, stop counting
            if (nextPlanet == currentDasaPlanet)
            {
                return dasaCount;
            }
            //else planet not found,
            else
            {
                //change to next planet 
                nextPlanet = GetNextDasaPlanet(nextPlanet);
                //increase count
                dasaCount++;
                //try checking again if it is same planet
                goto TryAgain;
            }

        }

        /// <summary>
        /// Gets the occuring dasa, bhukti & antaram for a person at the given time
        /// </summary>
        public static Dasas GetCurrentDasaBhuktiAntaram(Time birthTime, Time currentTime)
        {
            //get dasa planet at birth
            var moonConstellation = GetMoonConstellation(birthTime);
            var birthDasaPlanet = GetConstellationDasaPlanet(moonConstellation.GetConstellationName());

            //get time traversed in birth dasa
            var timeTraversedInDasa = GetYearsTraversedInBirthDasa(birthTime);

            //get time from birth to current time (converted to Dasa years ie. 360 days per year)
            var timeBetween = currentTime.Subtract(birthTime).TotalDays / 360.0;

            //combine years traversed at birth and years to current time
            //this is done to easily calculate to current dasa, bhukti & antaram
            var combinedYears = timeTraversedInDasa + timeBetween;
            var wholeDasa = GetDasaCountedFromInputDasa(birthDasaPlanet, combinedYears);

            return wholeDasa;
        }

        /// <summary>
        /// Counts from inputed dasa by years to dasa, bhukti & antaram
        /// Inputed planet is taken as birth dasa ("starting dasa" to count from)
        /// Note: It is easier to calculate from start of Dasa,
        ///       so years already traversed at birth must be added into inputed years
        /// Exp: Get dasa, bhukti & antaram planet 3.5 years from start of Sun dasa
        /// </summary>
        public static Dasas GetDasaCountedFromInputDasa(PlanetName startDasaPlanet, double years)
        {
            double dasaYears = years;
            double bhuktiYears; //will be filled when getting dasa
            double antaramYears; //will be filled when getting bhukti
            double sukshmaYears; //will be filled when getting antaram
            double pranaYears; //will be filled when getting prana

            //NOTE: Get Dasa prepares values for Get Bhukti and so on.

            //first get the major dasa planet
            var dasaPlanet = GetDasa();

            //based on major dasa get bhukti planet
            var bhuktiPlanet = GetBhukti();

            //based on bhukti get antaram planet
            var antaramPlanet = GetAntaram();

            //based on antaram get sukshma planet
            var sukshmaPlanet = GetSukshma();

            //based on sukshma get prana planet
            var pranaPlanet = GetPrana();


            return new Dasas() { Dasa = dasaPlanet, Bhukti = bhuktiPlanet, Antaram = antaramPlanet, Sukshma = sukshmaPlanet, Prana = pranaPlanet };


            //LOCAL FUNCTIONS
            PlanetName GetPrana()
            {
                //first possible Prana planet is the Sukshma planet
                var possiblePranaPlanet = sukshmaPlanet;

            //minus the possible Prana planet's full years
            MinusPranaYears:
                var pranaPlanetFullYears = GetPranaPlanetFullYears(dasaPlanet, bhuktiPlanet, antaramPlanet, sukshmaPlanet, possiblePranaPlanet);
                pranaYears -= pranaPlanetFullYears;

                //if remaining prana time is negative,
                //than current possible sukshma planet is correct
                if (pranaYears <= 0)
                {
                    //return possible planet as correct
                    return possiblePranaPlanet;
                }
                //else possible prana planet not correct, go to next one 
                else
                {
                    //change to next prana planet in order
                    possiblePranaPlanet = GetNextDasaPlanet(possiblePranaPlanet);
                    //go back to minus this planet's years
                    goto MinusPranaYears;
                }


            }

            PlanetName GetSukshma()
            {
                //first possible sukshma planet is the antaram planet
                var possibleSukshmaPlanet = antaramPlanet;

            //minus the possible sukshma planet's full years
            MinusSukshmaYears:
                var sukshmaPlanetFullYears = GetSukshmaPlanetFullYears(dasaPlanet, bhuktiPlanet, antaramPlanet, possibleSukshmaPlanet);
                sukshmaYears -= sukshmaPlanetFullYears;

                //if remaining sukshma years is negative,
                //than current possible sukshma planet is correct
                if (sukshmaYears <= 0)
                {
                    //get back the Sukshma time before it becomes negative
                    //this is the time inside the current Sukshma, aka Prana time
                    //save it for late use
                    pranaYears = sukshmaYears + sukshmaPlanetFullYears;

                    //return possible planet as correct
                    return possibleSukshmaPlanet;
                }
                //else possible sukshma planet not correct, go to next one 
                else
                {
                    //change to next sukshma planet in order
                    possibleSukshmaPlanet = GetNextDasaPlanet(possibleSukshmaPlanet);
                    //go back to minus this planet's years
                    goto MinusSukshmaYears;
                }


            }

            PlanetName GetAntaram()
            {
                //first possible antaram planet is the bhukti planet
                var possibleAntaramPlanet = bhuktiPlanet;

            //minus the possible antaram planet's full years
            MinusAntaramYears:
                var antaramPlanetFullYears = GetAntaramPlanetFullYears(dasaPlanet, bhuktiPlanet, possibleAntaramPlanet);
                antaramYears -= antaramPlanetFullYears;

                //if remaining antaram years is negative,
                //than current possible antaram planet is correct
                if (antaramYears <= 0)
                {
                    //get back the antaram time before it became negative
                    //this is the time inside the current antaram, aka Sukshma time
                    //save it for late use
                    sukshmaYears = antaramYears + antaramPlanetFullYears;

                    //return possible planet as correct
                    return possibleAntaramPlanet;
                }
                //else possible antaram planet not correct, go to next one 
                else
                {
                    //change to next antaram planet in order
                    possibleAntaramPlanet = GetNextDasaPlanet(possibleAntaramPlanet);
                    //go back to minus this planet's years
                    goto MinusAntaramYears;
                }


            }

            PlanetName GetBhukti()
            {
                //first possible bhukti planet is the major Dasa planet
                var possibleBhuktiPlanet = dasaPlanet;

            //minus the possible bhukti planet's full years
            MinusBhuktiYears:
                var bhuktiPlanetFullYears = GetBhuktiPlanetFullYears(dasaPlanet, possibleBhuktiPlanet);
                bhuktiYears -= bhuktiPlanetFullYears;

                //if remaining bhukti years is negative,
                //than current possible bhukti planet is correct
                if (bhuktiYears <= 0)
                {
                    //get back the bhukti years before it became negative
                    //this is the years inside the current bhukti, aka antaram years
                    //save it for late use
                    antaramYears = bhuktiYears + bhuktiPlanetFullYears;

                    //return possible planet as correct
                    return possibleBhuktiPlanet;
                }
                //else possible bhukti planet not correct, go to next one 
                else
                {
                    //change to next bhukti planet in order
                    possibleBhuktiPlanet = GetNextDasaPlanet(possibleBhuktiPlanet);
                    //go back to minus this planet's years
                    goto MinusBhuktiYears;
                }

            }

            PlanetName GetDasa()
            {
                //possible planet starts with the inputed one
                var possibleDasaPlanet = startDasaPlanet;

            //minus planet years
            MinusDasaYears:
                var dasaPlanetFullYears = GetDasaPlanetFullYears(possibleDasaPlanet);
                dasaYears -= dasaPlanetFullYears;

                //if remaining dasa years is negative,
                //than possible dasa planet is correct
                if (dasaYears <= 0)
                {
                    //get back the dasa years before it became negative
                    //this is the years inside the current dasa, aka bhukti years
                    //save it for late use
                    bhuktiYears = dasaYears + dasaPlanetFullYears;

                    //return possible planet as correct
                    return possibleDasaPlanet;
                }
                //else possible dasa planet not correct, go to next one 
                else
                {
                    //change to next dasa planet in order
                    possibleDasaPlanet = GetNextDasaPlanet(possibleDasaPlanet);
                    //go back to minus this planet's years
                    goto MinusDasaYears;
                }
            }

        }


        /// <summary>
        /// Gets next planet in Dasa order
        /// This order is also used for Bhukti & Antaram
        /// Ref:Hindu Predictive Astrology pg. 54
        /// </summary>
        public static PlanetName GetNextDasaPlanet(PlanetName planet)
        {
            if (planet == PlanetName.Sun) { return PlanetName.Moon; }
            if (planet == PlanetName.Moon) { return PlanetName.Mars; }
            if (planet == PlanetName.Mars) { return PlanetName.Rahu; }
            if (planet == PlanetName.Rahu) { return PlanetName.Jupiter; }
            if (planet == PlanetName.Jupiter) { return PlanetName.Saturn; }
            if (planet == PlanetName.Saturn) { return PlanetName.Mercury; }
            if (planet == PlanetName.Mercury) { return PlanetName.Ketu; }
            if (planet == PlanetName.Ketu) { return PlanetName.Venus; }
            if (planet == PlanetName.Venus) { return PlanetName.Sun; }

            //if no plant found something wrong
            throw new Exception("Planet not found!");

        }

        /// <summary>
        ///  Gets years left in birth dasa at birth
        ///  Note : Returned years can only be 0 or above
        /// </summary>
        [API("YearsLeftInBirthDasa")]
        public static double GetTimeLeftInBirthDasa(Time birthTime)
        {
            //get years already passed in birth dasa
            var yearsTraversed = GetYearsTraversedInBirthDasa(birthTime);

            //get full years of birth dasa planet
            var moonConstellation = GetMoonConstellation(birthTime);
            var birthDasaPlanet = GetConstellationDasaPlanet(moonConstellation.GetConstellationName());
            var fullYears = GetDasaPlanetFullYears(birthDasaPlanet);

            //calculate the years left in birth dasa at birth
            var yearsLeft = fullYears - yearsTraversed;

            //raise error if years traversed is more than full years
            if (yearsLeft < 0) { throw new Exception("Dasa years traversed is more than full years!"); }

            return yearsLeft;
        }

        /// <summary>
        /// Gets the time in years traversed in Dasa at birth
        /// </summary>
        public static double GetYearsTraversedInBirthDasa(Time birthTime)
        {
            //get longitude minutes the Moon already traveled in the constellation 
            var moonConstellation = GetMoonConstellation(birthTime);
            var minutesTraversed = moonConstellation.GetDegreesInConstellation().TotalMinutes;

            //get the time period each minute represents
            var timePerMinute = GetDasaTimePerMinute(moonConstellation.GetConstellationName());

            //calculate the years already traversed
            var traversedYears = minutesTraversed * timePerMinute;

            return traversedYears;
        }


        /// <summary>
        /// Gets the Dasa time period each longitude minute in a constellation represents,
        /// based on the planet which is related (lord) to it.
        /// Note: Returns the time in years, exp 0.5 = half year
        /// </summary>
        public static double GetDasaTimePerMinute(ConstellationName constellationName)
        {
            //maximum longitude minutes of a constellation
            const double maxMinutes = 800.0;

            //get the related (lord) planet for the constellation
            var relatedPlanet = GetConstellationDasaPlanet(constellationName);

            //get the full Dasa years for the related planet
            var fullYears = GetDasaPlanetFullYears(relatedPlanet);

            //calculate the time in years each longitude minute represents
            var timePerMinute = fullYears / maxMinutes;

            return timePerMinute;
        }

        /// <summary>
        /// Gets the full Dasa years for a given planet
        /// Note: Returns "double" so that division down the road is accurate
        /// Ref:Hindu Predictive Astrology pg. 54
        /// </summary>
        public static double GetDasaPlanetFullYears(PlanetName planet)
        {

            if (planet == PlanetName.Sun) { return 6.0; }
            if (planet == PlanetName.Moon) { return 10.0; }
            if (planet == PlanetName.Mars) { return 7.0; }
            if (planet == PlanetName.Rahu) { return 18.0; }
            if (planet == PlanetName.Jupiter) { return 16.0; }
            if (planet == PlanetName.Saturn) { return 19.0; }
            if (planet == PlanetName.Mercury) { return 17.0; }
            if (planet == PlanetName.Ketu) { return 7.0; }
            if (planet == PlanetName.Venus) { return 20.0; }

            //if no plant found something wrong
            throw new Exception("Planet not found!");

        }


        /// <summary>
        /// Gets the full years of a bhukti planet in a dasa
        /// </summary>
        public static double GetBhuktiPlanetFullYears(PlanetName dasaPlanet, PlanetName bhuktiPlanet)
        {
            //120 years is the total of all the dasa planet's years
            const double fullHumanLifeYears = 120.0;

            //the time a bhukti planet consumes in a dasa is
            //a fixed percentage it consumes in a person's full life
            var bhuktiPlanetPercentage = GetDasaPlanetFullYears(bhuktiPlanet) / fullHumanLifeYears;

            //bhukti planet's years in a dasa is percentage of the dasa planet's full years
            var bhuktiPlanetFullYears = bhuktiPlanetPercentage * GetDasaPlanetFullYears(dasaPlanet);

            //return the calculated value
            return bhuktiPlanetFullYears;

        }

        /// <summary>
        /// Gets the full years of an antaram planet in a bhukti of a dasa
        /// </summary>
        public static double GetAntaramPlanetFullYears(PlanetName dasaPlanet, PlanetName bhuktiPlanet, PlanetName antaramPlanet)
        {
            //120 years is the total of all the dasa planet's years
            const double fullHumanLifeYears = 120.0;

            //the time an antaram planet consumes in a bhukti is
            //a fixed percentage it consumes in a person's full life
            var antaramPlanetPercentage = GetDasaPlanetFullYears(antaramPlanet) / fullHumanLifeYears;

            //Antaram planet's full years is a percentage of the Bhukti planet's full years
            var antaramPlanetFullYears = antaramPlanetPercentage * GetBhuktiPlanetFullYears(dasaPlanet, bhuktiPlanet);

            //return the calculated value
            return antaramPlanetFullYears;

        }

        /// <summary>
        /// Gets the full time of an Sukshma planet 
        /// Sukshma is a Sanskrit word meaning "subtle" or "dormant." The presence of sukshma is felt, but not seen.
        /// </summary>
        public static double GetSukshmaPlanetFullYears(PlanetName dasaPlanet, PlanetName bhuktiPlanet, PlanetName antaramPlanet, PlanetName sukshmaPlanet)
        {
            //120 years is the total of all the dasa planet's years
            const double fullHumanLifeYears = 120.0;

            //the time an sukshma planet consumes in a antaram is
            //a fixed percentage it consumes in a person's full life
            var sukshmaPlanetPercentage = GetDasaPlanetFullYears(sukshmaPlanet) / fullHumanLifeYears;

            //sukshma planet's full years is a percentage of the Antaram planet's full years
            var sukshmaPlanetFullYears = sukshmaPlanetPercentage * GetAntaramPlanetFullYears(dasaPlanet, bhuktiPlanet, antaramPlanet);

            //return the calculated value
            return sukshmaPlanetFullYears;

        }

        /// <summary>
        /// Gets the full time of an Prana planet 
        /// </summary>
        public static double GetPranaPlanetFullYears(PlanetName dasaPlanet, PlanetName bhuktiPlanet, PlanetName antaramPlanet, PlanetName sukshmaPlanet, PlanetName pranaPlanet)
        {
            //120 years is the total of all the dasa planet's years
            const double fullHumanLifeYears = 120.0;

            //the time an Prana planet consumes in a Sukshma is
            //a fixed percentage it consumes in a person's full life
            var pranaPlanetPercentage = GetDasaPlanetFullYears(pranaPlanet) / fullHumanLifeYears;

            //Prana planet's full time is a percentage of the Sukshma planet's full time
            var pranaPlanetFullTime = pranaPlanetPercentage * GetSukshmaPlanetFullYears(dasaPlanet, bhuktiPlanet, antaramPlanet, sukshmaPlanet);

            //return the calculated value
            return pranaPlanetFullTime;

        }


        /// <summary>
        /// Gets the related (lord) Dasa planet for a given constellation
        /// Used to find the ruling Dasa Planet
        /// Ref:Hindu Predictive Astrology pg. 54
        /// </summary>
        public static PlanetName GetConstellationDasaPlanet(ConstellationName constellationName)
        {
            switch (constellationName)
            {
                case ConstellationName.Krithika:
                case ConstellationName.Uttara:
                case ConstellationName.Uttarashada:
                    return PlanetName.Sun;

                case ConstellationName.Rohini:
                case ConstellationName.Hasta:
                case ConstellationName.Sravana:
                    return PlanetName.Moon;

                case ConstellationName.Mrigasira:
                case ConstellationName.Chitta:
                case ConstellationName.Dhanishta:
                    return PlanetName.Mars;

                case ConstellationName.Aridra:
                case ConstellationName.Swathi:
                case ConstellationName.Satabhisha:
                    return PlanetName.Rahu;

                case ConstellationName.Punarvasu:
                case ConstellationName.Vishhaka:
                case ConstellationName.Poorvabhadra:
                    return PlanetName.Jupiter;

                case ConstellationName.Pushyami:
                case ConstellationName.Anuradha:
                case ConstellationName.Uttarabhadra:
                    return PlanetName.Saturn;

                case ConstellationName.Aslesha:
                case ConstellationName.Jyesta:
                case ConstellationName.Revathi:
                    return PlanetName.Mercury;

                case ConstellationName.Makha:
                case ConstellationName.Moola:
                case ConstellationName.Aswini:
                    return PlanetName.Ketu;

                case ConstellationName.Pubba:
                case ConstellationName.Poorvashada:
                case ConstellationName.Bharani:
                    return PlanetName.Venus;
            }

            //if it reaches here something wrong
            throw new Exception("Dasa planet for constellation not found!");
        }

        #endregion

    }
}
